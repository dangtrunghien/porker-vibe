============================= test session starts ==============================
platform linux -- Python 3.12.8, pytest-8.4.2, pluggy-1.6.0 -- /home/rowen/github-branches/vibe/.venv/bin/python3
cachedir: .pytest_cache
rootdir: /home/rowen/github-branches/vibe
configfile: pyproject.toml
plugins: asyncio-1.3.0, xdist-3.8.0, timeout-2.4.0, textual-snapshot-1.1.0, respx-0.22.0, syrupy-4.8.0, anyio-4.12.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
timeout: 10.0s
timeout method: signal
timeout func_only: False
created: 12/12 workers
12 workers [553 items]

scheduling tests via LoadScheduling

tests/acp/test_acp.py::TestSessionManagement::test_multiple_sessions_unique_ids 
tests/acp/test_bash.py::TestAcpBashBasic::test_get_summary_with_timeout 
[gw2] [  0%] PASSED tests/acp/test_bash.py::TestAcpBashBasic::test_get_summary_with_timeout 
tests/acp/test_bash.py::TestAcpBashBasic::test_parse_command_simple 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_sorted_by_score 
tests/acp/test_bash.py::TestAcpBashExecution::test_run_with_none_exit_code 
tests/autocompletion/test_fuzzy.py::test_treats_uppercase_letter_as_word_boundary 
[gw4] [  0%] PASSED tests/autocompletion/test_fuzzy.py::test_treats_uppercase_letter_as_word_boundary 
tests/autocompletion/test_fuzzy.py::test_favors_earlier_positions 
tests/acp/test_search_replace.py::TestAcpSearchReplaceExecution::test_run_write_error 
[gw9] [  0%] PASSED tests/acp/test_search_replace.py::TestAcpSearchReplaceExecution::test_run_write_error 
tests/acp/test_read_file.py::TestAcpReadFileExecution::test_run_success 
[gw10] [  0%] PASSED tests/acp/test_read_file.py::TestAcpReadFileExecution::test_run_success 
[gw4] [  0%] PASSED tests/autocompletion/test_fuzzy.py::test_favors_earlier_positions 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_subsequence_characters 
[gw2] [  1%] PASSED tests/acp/test_bash.py::TestAcpBashBasic::test_parse_command_simple 
tests/acp/test_bash.py::TestAcpBashBasic::test_parse_command_with_args 
tests/acp/test_search_replace.py::TestAcpSearchReplaceExecution::test_run_without_required_state[None-test_session-Connection not available in tool state. This tool can only be used within an ACP session.] 
tests/acp/test_read_file.py::TestAcpReadFileExecution::test_run_with_offset 
[gw2] [  1%] PASSED tests/acp/test_bash.py::TestAcpBashBasic::test_parse_command_with_args 
tests/acp/test_bash.py::TestAcpBashBasic::test_parse_command_with_env 
[gw9] [  1%] PASSED tests/acp/test_search_replace.py::TestAcpSearchReplaceExecution::test_run_without_required_state[None-test_session-Connection not available in tool state. This tool can only be used within an ACP session.] 
[gw8] [  1%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_sorted_by_score 
tests/acp/test_write_file.py::TestAcpWriteFileSessionUpdates::test_tool_result_session_update_invalid_result 
[gw5] [  1%] PASSED tests/acp/test_write_file.py::TestAcpWriteFileSessionUpdates::test_tool_result_session_update_invalid_result 
tests/autocompletion/test_file_indexer.py::test_updates_index_on_file_creation 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_nested_directories 
tests/acp/test_search_replace.py::TestAcpSearchReplaceExecution::test_run_without_required_state[connection1-None-Session ID not available in tool state. This tool can only be used within an ACP session.] 
[gw2] [  1%] PASSED tests/acp/test_bash.py::TestAcpBashBasic::test_parse_command_with_env 
[gw10] [  2%] PASSED tests/acp/test_read_file.py::TestAcpReadFileExecution::test_run_with_offset 
tests/acp/test_bash.py::TestAcpBashBasic::test_parse_command_with_env_value_contains_equals 
tests/acp/test_read_file.py::TestAcpReadFileExecution::test_run_with_limit 
tests/autocompletion/test_fuzzy.py::test_matches_exact_prefix 
[gw1] [  2%] PASSED tests/autocompletion/test_fuzzy.py::test_matches_exact_prefix 
tests/autocompletion/test_fuzzy.py::test_no_match_when_characters_are_out_of_order 
[gw1] [  2%] PASSED tests/autocompletion/test_fuzzy.py::test_no_match_when_characters_are_out_of_order 
tests/acp/test_set_mode.py::TestACPSetMode::test_set_mode_invalid_mode_returns_none 
[gw2] [  2%] PASSED tests/acp/test_bash.py::TestAcpBashBasic::test_parse_command_with_env_value_contains_equals 
tests/acp/test_bash.py::TestAcpBashExecution::test_run_success 
tests/acp/test_set_model.py::TestACPSetModel::test_set_model_preserves_conversation_history 
tests/autocompletion/test_fuzzy.py::test_treats_consecutive_characters_as_subsequence 
[gw4] [  2%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_subsequence_characters 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_consecutive_characters_higher 
[gw9] [  3%] PASSED tests/acp/test_search_replace.py::TestAcpSearchReplaceExecution::test_run_without_required_state[connection1-None-Session ID not available in tool state. This tool can only be used within an ACP session.] 
tests/acp/test_search_replace.py::TestAcpSearchReplaceSessionUpdates::test_tool_call_session_update 
[gw10] [  3%] PASSED tests/acp/test_read_file.py::TestAcpReadFileExecution::test_run_with_limit 
tests/acp/test_read_file.py::TestAcpReadFileExecution::test_run_with_offset_and_limit 
[gw8] [  3%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_nested_directories 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_partial_filename 
[gw9] [  3%] PASSED tests/acp/test_search_replace.py::TestAcpSearchReplaceSessionUpdates::test_tool_call_session_update 
tests/acp/test_search_replace.py::TestAcpSearchReplaceSessionUpdates::test_tool_call_session_update_invalid_args 
[gw10] [  3%] PASSED tests/acp/test_read_file.py::TestAcpReadFileExecution::test_run_with_offset_and_limit 
tests/acp/test_content.py::TestACPContent::test_resource_content 
[gw1] [  3%] PASSED tests/autocompletion/test_fuzzy.py::test_treats_consecutive_characters_as_subsequence 
tests/autocompletion/test_fuzzy.py::test_ignores_case 
tests/acp/test_read_file.py::TestAcpReadFileExecution::test_run_read_error 
[gw9] [  4%] PASSED tests/acp/test_search_replace.py::TestAcpSearchReplaceSessionUpdates::test_tool_call_session_update_invalid_args 
[gw4] [  4%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_consecutive_characters_higher 
tests/acp/test_search_replace.py::TestAcpSearchReplaceSessionUpdates::test_tool_result_session_update 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_prefix_highest 
[gw8] [  4%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_partial_filename 
[gw9] [  4%] PASSED tests/acp/test_search_replace.py::TestAcpSearchReplaceSessionUpdates::test_tool_result_session_update 
[gw1] [  4%] PASSED tests/autocompletion/test_fuzzy.py::test_ignores_case 
tests/acp/test_search_replace.py::TestAcpSearchReplaceSessionUpdates::test_tool_result_session_update_invalid_result 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_multiple_files_with_same_pattern 
[gw10] [  5%] PASSED tests/acp/test_read_file.py::TestAcpReadFileExecution::test_run_read_error 
tests/autocompletion/test_fuzzy.py::test_treats_scattered_characters_as_subsequence 
[gw9] [  5%] PASSED tests/acp/test_search_replace.py::TestAcpSearchReplaceSessionUpdates::test_tool_result_session_update_invalid_result 
tests/acp/test_read_file.py::TestAcpReadFileExecution::test_run_without_connection 
[gw4] [  5%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_prefix_highest 
tests/acp/test_set_mode.py::TestACPSetMode::test_set_mode_to_default 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_across_directory_boundaries 
[gw1] [  5%] PASSED tests/autocompletion/test_fuzzy.py::test_treats_scattered_characters_as_subsequence 
[gw10] [  5%] PASSED tests/acp/test_read_file.py::TestAcpReadFileExecution::test_run_without_connection 
tests/acp/test_read_file.py::TestAcpReadFileExecution::test_run_without_session_id 
[gw6] [  5%] PASSED tests/acp/test_bash.py::TestAcpBashExecution::test_run_with_none_exit_code 
tests/autocompletion/test_fuzzy.py::test_treats_path_separator_as_word_boundary 
[gw8] [  6%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_multiple_files_with_same_pattern 
tests/acp/test_bash.py::TestAcpBashTimeout::test_run_with_timeout_raises_error_and_kills 
[gw4] [  6%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_across_directory_boundaries 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_no_results_when_no_match 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_case_insensitive 
[gw10] [  6%] PASSED tests/acp/test_read_file.py::TestAcpReadFileExecution::test_run_without_session_id 
[gw1] [  6%] PASSED tests/autocompletion/test_fuzzy.py::test_treats_path_separator_as_word_boundary 
tests/acp/test_search_replace.py::TestAcpSearchReplaceBasic::test_get_name 
tests/autocompletion/test_fuzzy.py::test_prefers_word_boundary_matching_over_subsequence 
[gw10] [  6%] PASSED tests/acp/test_search_replace.py::TestAcpSearchReplaceBasic::test_get_name 
tests/acp/test_search_replace.py::TestAcpSearchReplaceExecution::test_run_success 
[gw4] [  7%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_case_insensitive 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_word_boundaries_preferred 
[gw1] [  7%] PASSED tests/autocompletion/test_fuzzy.py::test_prefers_word_boundary_matching_over_subsequence 
[gw10] [  7%] PASSED tests/acp/test_search_replace.py::TestAcpSearchReplaceExecution::test_run_success 
tests/acp/test_search_replace.py::TestAcpSearchReplaceExecution::test_run_with_backup 
tests/autocompletion/test_fuzzy.py::test_scores_exact_prefix_match_higher_than_consecutive_and_subsequence 
[gw8] [  7%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_no_results_when_no_match 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_directory_traversal 
[gw2] [  7%] PASSED tests/acp/test_bash.py::TestAcpBashExecution::test_run_success 
[gw10] [  7%] PASSED tests/acp/test_search_replace.py::TestAcpSearchReplaceExecution::test_run_with_backup 
tests/acp/test_search_replace.py::TestAcpSearchReplaceExecution::test_run_read_error 
[gw1] [  8%] PASSED tests/autocompletion/test_fuzzy.py::test_scores_exact_prefix_match_higher_than_consecutive_and_subsequence 
tests/autocompletion/test_fuzzy.py::test_finds_no_match_when_pattern_is_longer_than_entry 
[gw4] [  8%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_word_boundaries_preferred 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_empty_pattern_shows_all 
[gw8] [  8%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_directory_traversal 
tests/acp/test_bash.py::TestAcpBashExecution::test_run_creates_terminal_with_env_vars 
[gw1] [  8%] PASSED tests/autocompletion/test_fuzzy.py::test_finds_no_match_when_pattern_is_longer_than_entry 
tests/autocompletion/test_fuzzy.py::test_prefers_consecutive_match_over_subsequence 
[gw10] [  8%] PASSED tests/acp/test_search_replace.py::TestAcpSearchReplaceExecution::test_run_read_error 
tests/autocompletion/test_path_prompt_transformer.py::test_falls_back_to_link_for_binary_files 
[gw4] [  9%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_empty_pattern_shows_all 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_hidden_files_only_with_dot 
tests/autocompletion/test_path_completer_recursive.py::test_finds_files_recursively_by_filename 
[gw1] [  9%] PASSED tests/autocompletion/test_fuzzy.py::test_prefers_consecutive_match_over_subsequence 
tests/autocompletion/test_fuzzy.py::test_prefers_case_sensitive_match_over_case_insensitive 
[gw1] [  9%] PASSED tests/autocompletion/test_fuzzy.py::test_prefers_case_sensitive_match_over_case_insensitive 
tests/autocompletion/test_ui_chat_autocompletion.py::test_path_completion_popup_lists_files_and_directories 
[gw8] [  9%] PASSED tests/autocompletion/test_path_completer_recursive.py::test_finds_files_recursively_by_filename 
tests/autocompletion/test_path_completer_recursive.py::test_finds_files_recursively_by_partial_path 
[gw8] [  9%] PASSED tests/autocompletion/test_path_completer_recursive.py::test_finds_files_recursively_by_partial_path 
tests/autocompletion/test_path_completer_recursive.py::test_finds_files_recursively_with_subsequence 
[gw4] [  9%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_hidden_files_only_with_dot 
tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_directories_and_files 
[gw10] [ 10%] PASSED tests/autocompletion/test_path_prompt_transformer.py::test_falls_back_to_link_for_binary_files 
tests/autocompletion/test_path_prompt_transformer.py::test_excludes_supposed_binary_files_quickly_before_reading_content 
[gw10] [ 10%] PASSED tests/autocompletion/test_path_prompt_transformer.py::test_excludes_supposed_binary_files_quickly_before_reading_content 
tests/autocompletion/test_path_prompt_transformer.py::test_applies_max_embed_size_guard 
[gw10] [ 10%] PASSED tests/autocompletion/test_path_prompt_transformer.py::test_applies_max_embed_size_guard 
[gw4] [ 10%] PASSED tests/autocompletion/test_path_completer_fuzzy.py::test_fuzzy_matches_directories_and_files 
tests/autocompletion/test_slash_command_controller.py::test_on_key_tab_applies_selected_completion 
tests/autocompletion/test_path_prompt_transformer.py::test_parses_paths_with_special_characters_when_quoted 
[gw8] [ 10%] PASSED tests/autocompletion/test_path_completer_recursive.py::test_finds_files_recursively_with_subsequence 
tests/autocompletion/test_path_completer_recursive.py::test_finds_multiple_matches_recursively 
[gw4] [ 11%] PASSED tests/autocompletion/test_slash_command_controller.py::test_on_key_tab_applies_selected_completion 
tests/autocompletion/test_slash_command_controller.py::test_on_key_down_and_up_cycle_selection 
[gw10] [ 11%] PASSED tests/autocompletion/test_path_prompt_transformer.py::test_parses_paths_with_special_characters_when_quoted 
tests/autocompletion/test_path_prompt_transformer.py::test_deduplicates_identical_paths 
[gw4] [ 11%] PASSED tests/autocompletion/test_slash_command_controller.py::test_on_key_down_and_up_cycle_selection 
[gw8] [ 11%] PASSED tests/autocompletion/test_path_completer_recursive.py::test_finds_multiple_matches_recursively 
[gw10] [ 11%] PASSED tests/autocompletion/test_path_prompt_transformer.py::test_deduplicates_identical_paths 
tests/autocompletion/test_slash_command_controller.py::test_on_text_change_emits_matching_suggestions_in_insertion_order_and_ignores_duplicates 
tests/autocompletion/test_slash_command_controller.py::test_on_key_enter_submits_selected_completion 
tests/autocompletion/test_path_completer_recursive.py::test_prioritizes_exact_path_matches 
[gw10] [ 11%] PASSED tests/autocompletion/test_slash_command_controller.py::test_on_text_change_emits_matching_suggestions_in_insertion_order_and_ignores_duplicates 
tests/autocompletion/test_slash_command_controller.py::test_on_text_change_filters_suggestions_case_insensitively 
[gw10] [ 12%] PASSED tests/autocompletion/test_slash_command_controller.py::test_on_text_change_filters_suggestions_case_insensitively 
[gw4] [ 12%] PASSED tests/autocompletion/test_slash_command_controller.py::test_on_key_enter_submits_selected_completion 
tests/autocompletion/test_slash_command_controller.py::test_on_text_change_clears_suggestions_when_no_matches 
tests/autocompletion/test_ui_chat_autocompletion.py::test_popup_appears_with_matching_suggestions 
[gw10] [ 12%] PASSED tests/autocompletion/test_slash_command_controller.py::test_on_text_change_clears_suggestions_when_no_matches 
tests/autocompletion/test_slash_command_controller.py::test_on_text_change_limits_the_number_of_results_and_preserves_insertion_order 
[gw2] [ 12%] PASSED tests/acp/test_bash.py::TestAcpBashExecution::test_run_creates_terminal_with_env_vars 
[gw8] [ 12%] PASSED tests/autocompletion/test_path_completer_recursive.py::test_prioritizes_exact_path_matches 
[gw10] [ 13%] PASSED tests/autocompletion/test_slash_command_controller.py::test_on_text_change_limits_the_number_of_results_and_preserves_insertion_order 
tests/backend/test_backend.py::TestBackend::test_backend_complete[https://api.fireworks.ai-json_response0-result_data0] 
tests/acp/test_bash.py::TestAcpBashExecution::test_run_with_nonzero_exit_code 
tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming_error[https://api.fireworks.ai-GenericBackend-response1] 
[gw7] [ 13%] PASSED tests/acp/test_content.py::TestACPContent::test_resource_content 
tests/acp/test_content.py::TestACPContent::test_resource_link_content 
[gw11] [ 13%] PASSED tests/acp/test_set_mode.py::TestACPSetMode::test_set_mode_invalid_mode_returns_none 
tests/acp/test_set_mode.py::TestACPSetMode::test_set_mode_to_same_mode 
[gw2] [ 13%] PASSED tests/acp/test_bash.py::TestAcpBashExecution::test_run_with_nonzero_exit_code 
tests/acp/test_bash.py::TestAcpBashExecution::test_run_create_terminal_failure 
[gw2] [ 13%] PASSED tests/acp/test_bash.py::TestAcpBashExecution::test_run_create_terminal_failure 
tests/acp/test_bash.py::TestAcpBashExecution::test_run_without_connection 
[gw2] [ 13%] PASSED tests/acp/test_bash.py::TestAcpBashExecution::test_run_without_connection 
tests/acp/test_bash.py::TestAcpBashExecution::test_run_without_session_id 
[gw2] [ 14%] PASSED tests/acp/test_bash.py::TestAcpBashExecution::test_run_without_session_id 
tests/autocompletion/test_path_completer_recursive.py::test_finds_files_when_pattern_matches_directory_name 
[gw8] [ 14%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_complete[https://api.fireworks.ai-json_response0-result_data0] 
tests/backend/test_backend.py::TestBackend::test_backend_complete[https://api.fireworks.ai-json_response1-result_data1] 
[gw11] [ 14%] PASSED tests/acp/test_set_mode.py::TestACPSetMode::test_set_mode_to_same_mode 
tests/acp/test_set_mode.py::TestACPSetMode::test_set_mode_with_empty_string 
[gw8] [ 14%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_complete[https://api.fireworks.ai-json_response1-result_data1] 
tests/backend/test_backend.py::TestBackend::test_backend_complete[https://api.mistral.ai-json_response2-result_data2] 
[gw8] [ 14%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_complete[https://api.mistral.ai-json_response2-result_data2] 
tests/backend/test_backend.py::TestBackend::test_backend_complete[https://api.mistral.ai-json_response3-result_data3] 
[gw11] [ 15%] PASSED tests/acp/test_set_mode.py::TestACPSetMode::test_set_mode_with_empty_string 
tests/acp/test_set_model.py::TestACPSetModel::test_set_model_success 
[gw3] [ 15%] PASSED tests/acp/test_set_model.py::TestACPSetModel::test_set_model_preserves_conversation_history 
tests/acp/test_set_model.py::TestACPSetModel::test_set_model_resets_stats_with_new_model_pricing 
[gw7] [ 15%] PASSED tests/acp/test_content.py::TestACPContent::test_resource_link_content 
tests/acp/test_content.py::TestACPContent::test_resource_link_minimal 
[gw9] [ 15%] PASSED tests/acp/test_set_mode.py::TestACPSetMode::test_set_mode_to_default 
tests/acp/test_set_mode.py::TestACPSetMode::test_set_mode_to_auto_approve 
[gw2] [ 15%] FAILED tests/autocompletion/test_path_completer_recursive.py::test_finds_files_when_pattern_matches_directory_name 
tests/autocompletion/test_path_completion_controller.py::test_lists_root_entries 
[gw2] [ 15%] FAILED tests/autocompletion/test_path_completion_controller.py::test_lists_root_entries 
tests/autocompletion/test_path_completion_controller.py::test_suggests_hidden_entries_only_with_dot_prefix 
[gw2] [ 16%] PASSED tests/autocompletion/test_path_completion_controller.py::test_suggests_hidden_entries_only_with_dot_prefix 
tests/autocompletion/test_path_completion_controller.py::test_lists_nested_entries_when_prefixing_with_folder_name 
[gw2] [ 16%] FAILED tests/autocompletion/test_path_completion_controller.py::test_lists_nested_entries_when_prefixing_with_folder_name 
tests/autocompletion/test_path_completion_controller.py::test_resets_when_fragment_invalid 
[gw7] [ 16%] PASSED tests/acp/test_content.py::TestACPContent::test_resource_link_minimal 
tests/acp/test_initialize.py::TestACPInitialize::test_initialize 
[gw2] [ 16%] PASSED tests/autocompletion/test_path_completion_controller.py::test_resets_when_fragment_invalid 
tests/autocompletion/test_path_completion_controller.py::test_applies_selected_completion_on_tab_keycode 
[gw2] [ 16%] PASSED tests/autocompletion/test_path_completion_controller.py::test_applies_selected_completion_on_tab_keycode 
tests/autocompletion/test_path_completion_controller.py::test_applies_selected_completion_on_enter_keycode 
[gw2] [ 16%] FAILED tests/autocompletion/test_path_completion_controller.py::test_applies_selected_completion_on_enter_keycode 
tests/autocompletion/test_path_completion_controller.py::test_navigates_and_cycles_across_suggestions 
[gw2] [ 17%] FAILED tests/autocompletion/test_path_completion_controller.py::test_navigates_and_cycles_across_suggestions 
tests/autocompletion/test_path_completion_controller.py::test_limits_suggestions_to_ten 
[gw2] [ 17%] FAILED tests/autocompletion/test_path_completion_controller.py::test_limits_suggestions_to_ten 
tests/autocompletion/test_path_completion_controller.py::test_does_not_handle_when_cursor_at_beginning_of_input 
[gw2] [ 17%] PASSED tests/autocompletion/test_path_completion_controller.py::test_does_not_handle_when_cursor_at_beginning_of_input 
tests/cli/test_clipboard.py::test_get_copy_fns_with_xclip 
[gw2] [ 17%] PASSED tests/cli/test_clipboard.py::test_get_copy_fns_with_xclip 
tests/cli/test_clipboard.py::test_get_copy_fns_with_wl_copy 
[gw2] [ 17%] PASSED tests/cli/test_clipboard.py::test_get_copy_fns_with_wl_copy 
tests/cli/test_clipboard.py::test_get_copy_fns_with_both_system_tools 
[gw3] [ 18%] PASSED tests/acp/test_set_model.py::TestACPSetModel::test_set_model_resets_stats_with_new_model_pricing 
[gw9] [ 18%] PASSED tests/acp/test_set_mode.py::TestACPSetMode::test_set_mode_to_auto_approve 
[gw11] [ 18%] PASSED tests/acp/test_set_model.py::TestACPSetModel::test_set_model_success 
tests/acp/test_set_mode.py::TestACPSetMode::test_set_mode_to_plan 
tests/acp/test_write_file.py::TestAcpWriteFileBasic::test_get_name 
[gw2] [ 18%] PASSED tests/cli/test_clipboard.py::test_get_copy_fns_with_both_system_tools 
tests/acp/test_set_model.py::TestACPSetModel::test_set_model_invalid_model_returns_none 
[gw3] [ 18%] PASSED tests/acp/test_write_file.py::TestAcpWriteFileBasic::test_get_name 
tests/acp/test_write_file.py::TestAcpWriteFileExecution::test_run_success_new_file 
tests/cli/test_command_handlers.py::TestCommandHandlerSignatures::test_all_handlers_accept_user_input 
[gw8] [ 18%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_complete[https://api.mistral.ai-json_response3-result_data3] 
[gw2] [ 19%] PASSED tests/cli/test_command_handlers.py::TestCommandHandlerSignatures::test_all_handlers_accept_user_input 
tests/cli/test_command_handlers.py::TestCommandRegistry::test_all_commands_have_handlers 
tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming[https://api.fireworks.ai-chunks0-result_data0] 
[gw2] [ 19%] PASSED tests/cli/test_command_handlers.py::TestCommandRegistry::test_all_commands_have_handlers 
tests/cli/test_command_handlers.py::TestCommandRegistry::test_find_command_by_alias 
[gw3] [ 19%] PASSED tests/acp/test_write_file.py::TestAcpWriteFileExecution::test_run_success_new_file 
[gw2] [ 19%] PASSED tests/cli/test_command_handlers.py::TestCommandRegistry::test_find_command_by_alias 
tests/cli/test_command_handlers.py::TestCommandRegistry::test_unknown_command_returns_none 
tests/acp/test_write_file.py::TestAcpWriteFileExecution::test_run_success_overwrite 
[gw2] [ 19%] PASSED tests/cli/test_command_handlers.py::TestCommandRegistry::test_unknown_command_returns_none 
tests/cli/test_command_handlers.py::TestRalphCommands::test_ralph_commands_exist 
[gw2] [ 20%] PASSED tests/cli/test_command_handlers.py::TestRalphCommands::test_ralph_commands_exist 
tests/cli/test_no_markup_static.py::test_static_raises_on_invalid_markup 
[gw2] [ 20%] PASSED tests/cli/test_no_markup_static.py::test_static_raises_on_invalid_markup 
[gw3] [ 20%] PASSED tests/acp/test_write_file.py::TestAcpWriteFileExecution::test_run_success_overwrite 
tests/cli/test_no_markup_static.py::test_no_markup_static_allows_invalid_markup 
[gw2] [ 20%] PASSED tests/cli/test_no_markup_static.py::test_no_markup_static_allows_invalid_markup 
tests/acp/test_write_file.py::TestAcpWriteFileExecution::test_run_write_error 
tests/core/test_config_resolution.py::TestResolveConfigFile::test_resolves_local_config_when_exists_and_folder_is_trusted 
[gw2] [ 20%] PASSED tests/core/test_config_resolution.py::TestResolveConfigFile::test_resolves_local_config_when_exists_and_folder_is_trusted 
tests/core/test_config_resolution.py::TestResolveConfigFile::test_resolves_local_config_when_exists_and_folder_is_not_trusted 
[gw2] [ 20%] PASSED tests/core/test_config_resolution.py::TestResolveConfigFile::test_resolves_local_config_when_exists_and_folder_is_not_trusted 
[gw3] [ 21%] PASSED tests/acp/test_write_file.py::TestAcpWriteFileExecution::test_run_write_error 
tests/core/test_config_resolution.py::TestResolveConfigFile::test_falls_back_to_global_config_when_local_missing 
tests/acp/test_write_file.py::TestAcpWriteFileExecution::test_run_without_connection 
[gw2] [ 21%] PASSED tests/core/test_config_resolution.py::TestResolveConfigFile::test_falls_back_to_global_config_when_local_missing 
tests/core/test_config_resolution.py::TestResolveConfigFile::test_respects_vibe_home_env_var 
[gw2] [ 21%] PASSED tests/core/test_config_resolution.py::TestResolveConfigFile::test_respects_vibe_home_env_var 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_initializes_with_empty_lists_when_file_does_not_exist 
[gw2] [ 21%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_initializes_with_empty_lists_when_file_does_not_exist 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_loads_existing_file 
[gw3] [ 21%] PASSED tests/acp/test_write_file.py::TestAcpWriteFileExecution::test_run_without_connection 
tests/acp/test_write_file.py::TestAcpWriteFileExecution::test_run_without_session_id 
[gw2] [ 22%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_loads_existing_file 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_handles_corrupted_file 
[gw7] [ 22%] FAILED tests/acp/test_initialize.py::TestACPInitialize::test_initialize 
[gw2] [ 22%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_handles_corrupted_file 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_normalizes_paths_to_absolute 
tests/acp/test_initialize.py::TestACPInitialize::test_initialize_with_terminal_auth 
[gw2] [ 22%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_normalizes_paths_to_absolute 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_expands_user_home_in_paths 
[gw3] [ 22%] PASSED tests/acp/test_write_file.py::TestAcpWriteFileExecution::test_run_without_session_id 
[gw2] [ 22%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_expands_user_home_in_paths 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_is_trusted_returns_true_for_trusted_path 
tests/acp/test_write_file.py::TestAcpWriteFileSessionUpdates::test_tool_call_session_update 
[gw2] [ 23%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_is_trusted_returns_true_for_trusted_path 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_is_trusted_returns_false_for_untrusted_path 
[gw8] [ 23%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming[https://api.fireworks.ai-chunks0-result_data0] 
[gw3] [ 23%] PASSED tests/acp/test_write_file.py::TestAcpWriteFileSessionUpdates::test_tool_call_session_update 
tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming[https://api.fireworks.ai-chunks1-result_data1] 
[gw2] [ 23%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_is_trusted_returns_false_for_untrusted_path 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_is_trusted_returns_none_for_unknown_path 
tests/acp/test_write_file.py::TestAcpWriteFileSessionUpdates::test_tool_call_session_update_invalid_args 
[gw2] [ 23%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_is_trusted_returns_none_for_unknown_path 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_add_trusted_adds_path_to_trusted_list 
[gw3] [ 24%] PASSED tests/acp/test_write_file.py::TestAcpWriteFileSessionUpdates::test_tool_call_session_update_invalid_args 
[gw7] [ 24%] FAILED tests/acp/test_initialize.py::TestACPInitialize::test_initialize_with_terminal_auth 
[gw2] [ 24%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_add_trusted_adds_path_to_trusted_list 
tests/acp/test_write_file.py::TestAcpWriteFileSessionUpdates::test_tool_result_session_update 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_add_trusted_removes_path_from_untrusted 
tests/acp/test_multi_session.py::TestMultiSessionCore::test_different_sessions_use_different_agents 
[gw2] [ 24%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_add_trusted_removes_path_from_untrusted 
tests/onboarding/test_run_onboarding.py::test_exits_on_cancel 
[gw3] [ 24%] PASSED tests/acp/test_write_file.py::TestAcpWriteFileSessionUpdates::test_tool_result_session_update 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_add_trusted_idempotent 
[gw3] [ 24%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_add_trusted_idempotent 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_add_untrusted_adds_path_to_untrusted_list 
[gw11] [ 25%] PASSED tests/acp/test_set_model.py::TestACPSetModel::test_set_model_invalid_model_returns_none 
[gw2] [ 25%] PASSED tests/onboarding/test_run_onboarding.py::test_exits_on_cancel 
tests/acp/test_set_model.py::TestACPSetModel::test_set_model_to_same_model 
tests/onboarding/test_run_onboarding.py::test_warns_on_save_error 
[gw3] [ 25%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_add_untrusted_adds_path_to_untrusted_list 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_add_untrusted_removes_path_from_trusted 
[gw2] [ 25%] PASSED tests/onboarding/test_run_onboarding.py::test_warns_on_save_error 
tests/onboarding/test_run_onboarding.py::test_successfully_completes 
[gw3] [ 25%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_add_untrusted_removes_path_from_trusted 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_add_untrusted_idempotent 
[gw2] [ 26%] PASSED tests/onboarding/test_run_onboarding.py::test_successfully_completes 
tests/onboarding/test_ui_onboarding.py::test_ui_gets_through_the_onboarding_successfully 
[gw8] [ 26%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming[https://api.fireworks.ai-chunks1-result_data1] 
tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming[https://api.mistral.ai-chunks2-result_data2] 
[gw3] [ 26%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_add_untrusted_idempotent 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_persistence_across_instances 
[gw3] [ 26%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_persistence_across_instances 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_handles_multiple_paths 
[gw3] [ 26%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_handles_multiple_paths 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_handles_switching_between_trusted_and_untrusted 
[gw3] [ 26%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_handles_switching_between_trusted_and_untrusted 
tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_handles_missing_file_during_save 
[gw3] [ 27%] PASSED tests/core/test_trusted_folders.py::TestTrustedFoldersManager::test_handles_missing_file_during_save 
tests/skills/test_manager.py::TestSkillManagerSearchPaths::test_discovers_from_multiple_skill_paths 
[gw3] [ 27%] PASSED tests/skills/test_manager.py::TestSkillManagerSearchPaths::test_discovers_from_multiple_skill_paths 
tests/skills/test_manager.py::TestSkillManagerSearchPaths::test_first_discovered_wins_for_duplicates 
[gw3] [ 27%] PASSED tests/skills/test_manager.py::TestSkillManagerSearchPaths::test_first_discovered_wins_for_duplicates 
tests/skills/test_manager.py::TestSkillManagerSearchPaths::test_ignores_nonexistent_skill_paths 
[gw3] [ 27%] PASSED tests/skills/test_manager.py::TestSkillManagerSearchPaths::test_ignores_nonexistent_skill_paths 
tests/skills/test_manager.py::TestSkillManagerGetSkill::test_returns_skill_by_name 
[gw3] [ 27%] PASSED tests/skills/test_manager.py::TestSkillManagerGetSkill::test_returns_skill_by_name 
tests/skills/test_manager.py::TestSkillManagerGetSkill::test_returns_none_for_unknown_skill 
[gw3] [ 28%] PASSED tests/skills/test_manager.py::TestSkillManagerGetSkill::test_returns_none_for_unknown_skill 
tests/skills/test_models.py::TestSkillMetadata::test_creates_with_required_fields 
[gw3] [ 28%] PASSED tests/skills/test_models.py::TestSkillMetadata::test_creates_with_required_fields 
tests/skills/test_models.py::TestSkillMetadata::test_creates_with_all_fields 
[gw3] [ 28%] PASSED tests/skills/test_models.py::TestSkillMetadata::test_creates_with_all_fields 
tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_uppercase_name 
[gw3] [ 28%] PASSED tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_uppercase_name 
tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_invalid_chars_in_name 
[gw3] [ 28%] PASSED tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_invalid_chars_in_name 
tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_consecutive_hyphens 
[gw3] [ 28%] PASSED tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_consecutive_hyphens 
tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_leading_trailing_hyphens 
[gw3] [ 29%] PASSED tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_leading_trailing_hyphens 
tests/skills/test_models.py::TestSkillMetadata::test_parses_allowed_tools_from_space_delimited_string 
[gw3] [ 29%] PASSED tests/skills/test_models.py::TestSkillMetadata::test_parses_allowed_tools_from_space_delimited_string 
tests/skills/test_models.py::TestSkillMetadata::test_parses_allowed_tools_from_list 
[gw3] [ 29%] PASSED tests/skills/test_models.py::TestSkillMetadata::test_parses_allowed_tools_from_list 
tests/skills/test_models.py::TestSkillMetadata::test_parses_allowed_tools_handles_none 
[gw3] [ 29%] PASSED tests/skills/test_models.py::TestSkillMetadata::test_parses_allowed_tools_handles_none 
tests/skills/test_models.py::TestSkillMetadata::test_normalizes_metadata_values_to_strings 
[gw3] [ 29%] PASSED tests/skills/test_models.py::TestSkillMetadata::test_normalizes_metadata_values_to_strings 
[gw8] [ 30%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming[https://api.mistral.ai-chunks2-result_data2] 
tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_missing_name 
tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming[https://api.mistral.ai-chunks3-result_data3] 
[gw3] [ 30%] PASSED tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_missing_name 
tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_missing_description 
[gw3] [ 30%] PASSED tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_missing_description 
tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_empty_name 
[gw3] [ 30%] PASSED tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_empty_name 
tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_empty_description 
[gw3] [ 30%] PASSED tests/skills/test_models.py::TestSkillMetadata::test_raises_error_for_empty_description 
[gw9] [ 30%] PASSED tests/acp/test_set_mode.py::TestACPSetMode::test_set_mode_to_plan 
tests/skills/test_models.py::TestSkillInfo::test_creates_from_metadata 
tests/acp/test_set_mode.py::TestACPSetMode::test_set_mode_to_accept_edits 
[gw3] [ 31%] PASSED tests/skills/test_models.py::TestSkillInfo::test_creates_from_metadata 
tests/skills/test_models.py::TestSkillInfo::test_creates_with_all_fields 
[gw3] [ 31%] PASSED tests/skills/test_models.py::TestSkillInfo::test_creates_with_all_fields 
tests/skills/test_models.py::TestSkillInfo::test_from_metadata_resolves_paths 
[gw3] [ 31%] PASSED tests/skills/test_models.py::TestSkillInfo::test_from_metadata_resolves_paths 
tests/skills/test_models.py::TestSkillInfo::test_inherits_all_metadata_fields 
[gw11] [ 31%] PASSED tests/acp/test_set_model.py::TestACPSetModel::test_set_model_to_same_model 
tests/acp/test_set_model.py::TestACPSetModel::test_set_model_saves_to_config 
[gw3] [ 31%] PASSED tests/skills/test_models.py::TestSkillInfo::test_inherits_all_metadata_fields 
tests/skills/test_parser.py::TestParseFrontmatter::test_parses_valid_frontmatter 
[gw3] [ 32%] PASSED tests/skills/test_parser.py::TestParseFrontmatter::test_parses_valid_frontmatter 
tests/skills/test_parser.py::TestParseFrontmatter::test_parses_frontmatter_with_all_fields 
[gw3] [ 32%] PASSED tests/skills/test_parser.py::TestParseFrontmatter::test_parses_frontmatter_with_all_fields 
tests/skills/test_parser.py::TestParseFrontmatter::test_raises_error_for_missing_frontmatter 
[gw3] [ 32%] PASSED tests/skills/test_parser.py::TestParseFrontmatter::test_raises_error_for_missing_frontmatter 
tests/skills/test_parser.py::TestParseFrontmatter::test_raises_error_for_unclosed_frontmatter 
[gw3] [ 32%] PASSED tests/skills/test_parser.py::TestParseFrontmatter::test_raises_error_for_unclosed_frontmatter 
tests/skills/test_parser.py::TestParseFrontmatter::test_raises_error_for_invalid_yaml 
[gw3] [ 32%] PASSED tests/skills/test_parser.py::TestParseFrontmatter::test_raises_error_for_invalid_yaml 
tests/skills/test_parser.py::TestParseFrontmatter::test_raises_error_for_non_dict_frontmatter 
[gw3] [ 32%] PASSED tests/skills/test_parser.py::TestParseFrontmatter::test_raises_error_for_non_dict_frontmatter 
tests/skills/test_parser.py::TestParseFrontmatter::test_handles_empty_frontmatter 
[gw3] [ 33%] PASSED tests/skills/test_parser.py::TestParseFrontmatter::test_handles_empty_frontmatter 
tests/skills/test_parser.py::TestParseFrontmatter::test_handles_frontmatter_with_no_body 
[gw3] [ 33%] PASSED tests/skills/test_parser.py::TestParseFrontmatter::test_handles_frontmatter_with_no_body 
tests/snapshots/test_ui_snapshot_basic_conversation.py::test_snapshot_shows_basic_conversation 
[gw8] [ 33%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming[https://api.mistral.ai-chunks3-result_data3] 
tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming_error[https://api.fireworks.ai-GenericBackend-response0] 
[gw7] [ 33%] PASSED tests/acp/test_multi_session.py::TestMultiSessionCore::test_different_sessions_use_different_agents 
tests/acp/test_multi_session.py::TestMultiSessionCore::test_error_on_nonexistent_session 
[gw9] [ 33%] PASSED tests/acp/test_set_mode.py::TestACPSetMode::test_set_mode_to_accept_edits 
tests/autocompletion/test_path_completion_controller.py::test_does_not_handle_when_cursor_before_or_at_the_at_symbol 
[gw9] [ 33%] PASSED tests/autocompletion/test_path_completion_controller.py::test_does_not_handle_when_cursor_before_or_at_the_at_symbol 
tests/autocompletion/test_path_completion_controller.py::test_does_handle_when_cursor_after_the_at_symbol_even_in_the_middle_of_the_input 
[gw9] [ 34%] PASSED tests/autocompletion/test_path_completion_controller.py::test_does_handle_when_cursor_after_the_at_symbol_even_in_the_middle_of_the_input 
tests/autocompletion/test_path_completion_controller.py::test_lists_immediate_children_when_path_ends_with_slash 
[gw7] [ 34%] PASSED tests/acp/test_multi_session.py::TestMultiSessionCore::test_error_on_nonexistent_session 
tests/acp/test_multi_session.py::TestMultiSessionCore::test_simultaneous_message_processing 
[gw11] [ 34%] PASSED tests/acp/test_set_model.py::TestACPSetModel::test_set_model_saves_to_config 
tests/acp/test_set_model.py::TestACPSetModel::test_set_model_does_not_save_on_invalid_model 
[gw1] [ 34%] PASSED tests/autocompletion/test_ui_chat_autocompletion.py::test_path_completion_popup_lists_files_and_directories 
tests/autocompletion/test_ui_chat_autocompletion.py::test_path_completion_popup_shows_up_to_ten_results 
[gw11] [ 34%] PASSED tests/acp/test_set_model.py::TestACPSetModel::test_set_model_does_not_save_on_invalid_model 
tests/acp/test_set_model.py::TestACPSetModel::test_set_model_with_empty_string 
[gw9] [ 35%] FAILED tests/autocompletion/test_path_completion_controller.py::test_lists_immediate_children_when_path_ends_with_slash 
tests/autocompletion/test_path_completion_controller.py::test_respects_max_entries_to_process_limit 
[gw9] [ 35%] PASSED tests/autocompletion/test_path_completion_controller.py::test_respects_max_entries_to_process_limit 
tests/autocompletion/test_path_completion_controller.py::test_respects_target_matches_limit_for_listing 
[gw9] [ 35%] PASSED tests/autocompletion/test_path_completion_controller.py::test_respects_target_matches_limit_for_listing 
tests/autocompletion/test_path_completion_controller.py::test_respects_target_matches_limit_for_fuzzy_search 
[gw7] [ 35%] PASSED tests/acp/test_multi_session.py::TestMultiSessionCore::test_simultaneous_message_processing 
tests/acp/test_new_session.py::TestACPNewSession::test_new_session_response_structure 
[gw11] [ 35%] PASSED tests/acp/test_set_model.py::TestACPSetModel::test_set_model_with_empty_string 
tests/acp/test_set_model.py::TestACPSetModel::test_set_model_updates_active_model 
[gw9] [ 35%] PASSED tests/autocompletion/test_path_completion_controller.py::test_respects_target_matches_limit_for_fuzzy_search 
tests/autocompletion/test_path_prompt_transformer.py::test_treats_paths_to_files_as_embedded_resources 
[gw9] [ 36%] PASSED tests/autocompletion/test_path_prompt_transformer.py::test_treats_paths_to_files_as_embedded_resources 
tests/autocompletion/test_path_prompt_transformer.py::test_treats_path_to_directory_as_resource_links 
[gw9] [ 36%] PASSED tests/autocompletion/test_path_prompt_transformer.py::test_treats_path_to_directory_as_resource_links 
tests/autocompletion/test_path_prompt_transformer.py::test_keeps_emails_and_embeds_paths 
[gw9] [ 36%] PASSED tests/autocompletion/test_path_prompt_transformer.py::test_keeps_emails_and_embeds_paths 
tests/autocompletion/test_path_prompt_transformer.py::test_ignores_nonexistent_paths 
[gw9] [ 36%] PASSED tests/autocompletion/test_path_prompt_transformer.py::test_ignores_nonexistent_paths 
tests/test_agent_observer_streaming.py::test_reasoning_buffer_yields_before_content_with_batching 
[gw9] [ 36%] PASSED tests/test_agent_observer_streaming.py::test_reasoning_buffer_yields_before_content_with_batching 
tests/test_agent_observer_streaming.py::test_content_buffer_yields_before_reasoning_on_transition 
[gw11] [ 37%] PASSED tests/acp/test_set_model.py::TestACPSetModel::test_set_model_updates_active_model 
tests/acp/test_set_model.py::TestACPSetModel::test_set_model_calls_reload_with_initial_messages 
[gw9] [ 37%] PASSED tests/test_agent_observer_streaming.py::test_content_buffer_yields_before_reasoning_on_transition 
tests/test_agent_observer_streaming.py::test_interleaved_reasoning_content_preserves_order 
[gw7] [ 37%] PASSED tests/acp/test_new_session.py::TestACPNewSession::test_new_session_response_structure 
tests/acp/test_new_session.py::TestACPNewSession::test_new_session_preserves_model_after_set_model 
[gw9] [ 37%] PASSED tests/test_agent_observer_streaming.py::test_interleaved_reasoning_content_preserves_order 
tests/test_agent_observer_streaming.py::test_only_reasoning_chunks_yields_reasoning_event 
[gw9] [ 37%] PASSED tests/test_agent_observer_streaming.py::test_only_reasoning_chunks_yields_reasoning_event 
tests/test_agent_observer_streaming.py::test_final_buffers_flush_in_correct_order 
[gw11] [ 37%] PASSED tests/acp/test_set_model.py::TestACPSetModel::test_set_model_calls_reload_with_initial_messages 
tests/test_agent_backend.py::test_updates_tokens_stats_based_on_backend_response_streaming 
[gw4] [ 38%] PASSED tests/autocompletion/test_ui_chat_autocompletion.py::test_popup_appears_with_matching_suggestions 
tests/autocompletion/test_ui_chat_autocompletion.py::test_popup_hides_when_input_cleared 
[gw9] [ 38%] PASSED tests/test_agent_observer_streaming.py::test_final_buffers_flush_in_correct_order 
tests/test_agent_observer_streaming.py::test_empty_content_chunks_do_not_trigger_false_yields 
[gw9] [ 38%] PASSED tests/test_agent_observer_streaming.py::test_empty_content_chunks_do_not_trigger_false_yields 
tests/test_agent_stats.py::TestAgentStatsHelpers::test_update_pricing 
[gw9] [ 38%] PASSED tests/test_agent_stats.py::TestAgentStatsHelpers::test_update_pricing 
tests/test_agent_stats.py::TestAgentStatsHelpers::test_reset_context_state_preserves_cumulative 
[gw9] [ 38%] PASSED tests/test_agent_stats.py::TestAgentStatsHelpers::test_reset_context_state_preserves_cumulative 
tests/test_agent_stats.py::TestAgentStatsHelpers::test_session_cost_computed_from_current_pricing 
[gw9] [ 39%] PASSED tests/test_agent_stats.py::TestAgentStatsHelpers::test_session_cost_computed_from_current_pricing 
tests/test_agent_stats.py::TestReloadPreservesStats::test_reload_preserves_session_tokens 
[gw11] [ 39%] PASSED tests/test_agent_backend.py::test_updates_tokens_stats_based_on_backend_response_streaming 
tests/test_agent_observer_streaming.py::test_act_flushes_batched_messages_with_injection_middleware 
[gw7] [ 39%] FAILED tests/acp/test_new_session.py::TestACPNewSession::test_new_session_preserves_model_after_set_model 
tests/acp/test_read_file.py::TestAcpReadFileBasic::test_get_name 
[gw7] [ 39%] PASSED tests/acp/test_read_file.py::TestAcpReadFileBasic::test_get_name 
tests/snapshots/test_ui_snapshot_reasoning_content.py::test_snapshot_buffered_reasoning_yields_before_content 
[gw5] [ 39%] PASSED tests/autocompletion/test_file_indexer.py::test_updates_index_on_file_creation 
[gw9] [ 39%] PASSED tests/test_agent_stats.py::TestReloadPreservesStats::test_reload_preserves_session_tokens 
tests/test_agent_stats.py::TestReloadPreservesStats::test_reload_preserves_steps 
[gw11] [ 40%] FAILED tests/test_agent_observer_streaming.py::test_act_flushes_batched_messages_with_injection_middleware 
tests/test_agent_observer_streaming.py::test_stop_action_flushes_user_msg_before_returning 
[gw9] [ 40%] PASSED tests/test_agent_stats.py::TestReloadPreservesStats::test_reload_preserves_steps 
tests/test_agent_stats.py::TestReloadPreservesStats::test_reload_preserves_context_tokens_when_messages_preserved 
tests/autocompletion/test_file_indexer.py::test_updates_index_on_file_deletion 
[gw11] [ 40%] FAILED tests/test_agent_observer_streaming.py::test_stop_action_flushes_user_msg_before_returning 
tests/test_agent_observer_streaming.py::test_act_emits_user_and_assistant_msgs 
[gw9] [ 40%] PASSED tests/test_agent_stats.py::TestReloadPreservesStats::test_reload_preserves_context_tokens_when_messages_preserved 
tests/test_agent_stats.py::TestReloadPreservesStats::test_reload_resets_context_tokens_when_no_messages 
[gw11] [ 40%] PASSED tests/test_agent_observer_streaming.py::test_act_emits_user_and_assistant_msgs 
tests/test_agent_observer_streaming.py::test_act_streams_batched_chunks_in_order 
[gw11] [ 41%] PASSED tests/test_agent_observer_streaming.py::test_act_streams_batched_chunks_in_order 
tests/test_agent_observer_streaming.py::test_act_flushes_and_logs_when_streaming_errors 
[gw0] [ 41%] PASSED tests/acp/test_acp.py::TestSessionManagement::test_multiple_sessions_unique_ids 
tests/acp/test_acp.py::TestSessionUpdates::test_agent_message_chunk_structure 
[gw9] [ 41%] PASSED tests/test_agent_stats.py::TestReloadPreservesStats::test_reload_resets_context_tokens_when_no_messages 
tests/test_agent_stats.py::TestReloadPreservesStats::test_reload_resets_context_tokens_when_system_prompt_changes 
[gw11] [ 41%] PASSED tests/test_agent_observer_streaming.py::test_act_flushes_and_logs_when_streaming_errors 
tests/test_agent_observer_streaming.py::test_reasoning_buffer_yields_before_content_on_transition 
[gw6] [ 41%] PASSED tests/acp/test_bash.py::TestAcpBashTimeout::test_run_with_timeout_raises_error_and_kills 
tests/acp/test_bash.py::TestAcpBashTimeout::test_run_timeout_handles_kill_failure 
[gw11] [ 41%] PASSED tests/test_agent_observer_streaming.py::test_reasoning_buffer_yields_before_content_on_transition 
tests/test_agent_stats.py::TestReloadPreservesMessages::test_reload_with_no_messages_stays_empty 
[gw9] [ 42%] PASSED tests/test_agent_stats.py::TestReloadPreservesStats::test_reload_resets_context_tokens_when_system_prompt_changes 
tests/test_agent_stats.py::TestReloadPreservesStats::test_reload_updates_pricing_from_new_model 
[gw9] [ 42%] PASSED tests/test_agent_stats.py::TestReloadPreservesStats::test_reload_updates_pricing_from_new_model 
tests/test_agent_stats.py::TestReloadPreservesStats::test_reload_accumulates_tokens_across_configs 
[gw11] [ 42%] PASSED tests/test_agent_stats.py::TestReloadPreservesMessages::test_reload_with_no_messages_stays_empty 
tests/test_agent_stats.py::TestReloadPreservesMessages::test_reload_notifies_observer_with_all_messages 
[gw4] [ 42%] PASSED tests/autocompletion/test_ui_chat_autocompletion.py::test_popup_hides_when_input_cleared 
[gw9] [ 42%] PASSED tests/test_agent_stats.py::TestReloadPreservesStats::test_reload_accumulates_tokens_across_configs 
tests/autocompletion/test_ui_chat_autocompletion.py::test_pressing_tab_writes_selected_command_and_keeps_popup_visible 
tests/test_agent_stats.py::TestReloadPreservesMessages::test_reload_preserves_conversation_messages 
[gw11] [ 43%] PASSED tests/test_agent_stats.py::TestReloadPreservesMessages::test_reload_notifies_observer_with_all_messages 
tests/test_agent_stats.py::TestCompactStatsHandling::test_compact_preserves_cumulative_stats 
[gw9] [ 43%] PASSED tests/test_agent_stats.py::TestReloadPreservesMessages::test_reload_preserves_conversation_messages 
tests/test_agent_stats.py::TestReloadPreservesMessages::test_reload_updates_system_prompt_preserves_rest 
[gw11] [ 43%] PASSED tests/test_agent_stats.py::TestCompactStatsHandling::test_compact_preserves_cumulative_stats 
tests/test_agent_stats.py::TestCompactStatsHandling::test_compact_updates_context_tokens 
[gw9] [ 43%] PASSED tests/test_agent_stats.py::TestReloadPreservesMessages::test_reload_updates_system_prompt_preserves_rest 
tests/test_agent_stats.py::TestClearHistoryFullReset::test_clear_history_fully_resets_stats 
[gw11] [ 43%] PASSED tests/test_agent_stats.py::TestCompactStatsHandling::test_compact_updates_context_tokens 
tests/test_agent_stats.py::TestCompactStatsHandling::test_compact_resets_session_id 
[gw9] [ 43%] PASSED tests/test_agent_stats.py::TestClearHistoryFullReset::test_clear_history_fully_resets_stats 
tests/test_agent_stats.py::TestClearHistoryFullReset::test_clear_history_preserves_pricing 
[gw11] [ 44%] PASSED tests/test_agent_stats.py::TestCompactStatsHandling::test_compact_resets_session_id 
tests/test_agent_stats.py::TestAutoCompactIntegration::test_auto_compact_triggers_and_preserves_stats 
[gw9] [ 44%] PASSED tests/test_agent_stats.py::TestClearHistoryFullReset::test_clear_history_preserves_pricing 
tests/test_agent_stats.py::TestClearHistoryFullReset::test_clear_history_removes_messages 
[gw9] [ 44%] PASSED tests/test_agent_stats.py::TestClearHistoryFullReset::test_clear_history_removes_messages 
tests/test_agent_stats.py::TestClearHistoryFullReset::test_clear_history_resets_session_id 
[gw5] [ 44%] PASSED tests/autocompletion/test_file_indexer.py::test_updates_index_on_file_deletion 
[gw9] [ 44%] PASSED tests/test_agent_stats.py::TestClearHistoryFullReset::test_clear_history_resets_session_id 
tests/test_agent_stats.py::TestStatsEdgeCases::test_session_cost_approximation_on_model_change 
[gw11] [ 45%] FAILED tests/test_agent_stats.py::TestAutoCompactIntegration::test_auto_compact_triggers_and_preserves_stats 
tests/test_agent_stats.py::TestStatsEdgeCases::test_compact_then_reload_preserves_both 
[gw9] [ 45%] PASSED tests/test_agent_stats.py::TestStatsEdgeCases::test_session_cost_approximation_on_model_change 
tests/test_agent_stats.py::TestStatsEdgeCases::test_multiple_reloads_accumulate_correctly 
[gw10] [ 45%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming_error[https://api.fireworks.ai-GenericBackend-response1] 
tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming_error[https://api.mistral.ai-MistralBackend-response2] 
tests/autocompletion/test_file_indexer.py::test_updates_index_on_file_rename 
[gw10] [ 45%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming_error[https://api.mistral.ai-MistralBackend-response2] 
tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming_error[https://api.mistral.ai-MistralBackend-response3] 
[gw11] [ 45%] PASSED tests/test_agent_stats.py::TestStatsEdgeCases::test_compact_then_reload_preserves_both 
tests/test_agent_stats.py::TestStatsEdgeCases::test_reload_without_config_preserves_current 
[gw10] [ 45%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming_error[https://api.mistral.ai-MistralBackend-response3] 
tests/backend/test_backend.py::TestBackend::test_backend_streaming_payload_includes_stream_options[https://api.fireworks.ai-fireworks-expected_stream_options0] 
[gw10] [ 46%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_streaming_payload_includes_stream_options[https://api.fireworks.ai-fireworks-expected_stream_options0] 
tests/backend/test_backend.py::TestBackend::test_backend_streaming_payload_includes_stream_options[https://api.mistral.ai-mistral-expected_stream_options1] 
[gw10] [ 46%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_streaming_payload_includes_stream_options[https://api.mistral.ai-mistral-expected_stream_options1] 
tests/backend/test_backend.py::TestBackend::test_backend_user_agent[mistral] 
[gw11] [ 46%] PASSED tests/test_agent_stats.py::TestStatsEdgeCases::test_reload_without_config_preserves_current 
tests/test_agent_stats.py::TestStatsEdgeCases::test_reload_with_new_config_updates_it 
[gw10] [ 46%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_user_agent[mistral] 
tests/backend/test_backend.py::TestBackend::test_backend_user_agent[generic] 
[gw10] [ 46%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_user_agent[generic] 
tests/backend/test_backend.py::TestBackend::test_backend_user_agent_when_streaming[mistral] 
[gw11] [ 47%] PASSED tests/test_agent_stats.py::TestStatsEdgeCases::test_reload_with_new_config_updates_it 
tests/test_agent_tool_call.py::test_tool_call_can_be_interrupted[keyboard_interrupt] 
[gw10] [ 47%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_user_agent_when_streaming[mistral] 
tests/backend/test_backend.py::TestBackend::test_backend_user_agent_when_streaming[generic] 
[gw10] [ 47%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_user_agent_when_streaming[generic] 
tests/test_middleware.py::TestPlanModeMiddleware::test_does_not_inject_when_auto_approve_mode 
[gw10] [ 47%] PASSED tests/test_middleware.py::TestPlanModeMiddleware::test_does_not_inject_when_auto_approve_mode 
tests/test_middleware.py::TestPlanModeMiddleware::test_does_not_inject_when_accept_edits_mode 
[gw10] [ 47%] PASSED tests/test_middleware.py::TestPlanModeMiddleware::test_does_not_inject_when_accept_edits_mode 
tests/test_middleware.py::TestPlanModeMiddleware::test_after_turn_always_continues 
[gw9] [ 47%] PASSED tests/test_agent_stats.py::TestStatsEdgeCases::test_multiple_reloads_accumulate_correctly 
[gw10] [ 48%] PASSED tests/test_middleware.py::TestPlanModeMiddleware::test_after_turn_always_continues 
tests/test_cli_programmatic_preload.py::test_run_programmatic_preload_streaming_is_batched 
tests/test_middleware.py::TestPlanModeMiddleware::test_dynamically_checks_mode 
[gw10] [ 48%] PASSED tests/test_middleware.py::TestPlanModeMiddleware::test_dynamically_checks_mode 
tests/test_middleware.py::TestPlanModeMiddleware::test_custom_reminder 
[gw10] [ 48%] PASSED tests/test_middleware.py::TestPlanModeMiddleware::test_custom_reminder 
tests/test_middleware.py::TestPlanModeMiddleware::test_reset_does_nothing 
[gw10] [ 48%] PASSED tests/test_middleware.py::TestPlanModeMiddleware::test_reset_does_nothing 
tests/test_middleware.py::TestMiddlewarePipelineWithPlanMode::test_pipeline_includes_plan_mode_injection 
[gw10] [ 48%] PASSED tests/test_middleware.py::TestMiddlewarePipelineWithPlanMode::test_pipeline_includes_plan_mode_injection 
tests/test_middleware.py::TestMiddlewarePipelineWithPlanMode::test_pipeline_skips_injection_when_not_plan_mode 
[gw10] [ 49%] PASSED tests/test_middleware.py::TestMiddlewarePipelineWithPlanMode::test_pipeline_skips_injection_when_not_plan_mode 
tests/test_modes.py::TestModeSafety::test_safety_enum_values 
[gw10] [ 49%] PASSED tests/test_modes.py::TestModeSafety::test_safety_enum_values 
tests/test_modes.py::TestModeSafety::test_default_mode_is_neutral 
[gw10] [ 49%] PASSED tests/test_modes.py::TestModeSafety::test_default_mode_is_neutral 
tests/test_modes.py::TestModeSafety::test_auto_approve_mode_is_yolo 
[gw10] [ 49%] PASSED tests/test_modes.py::TestModeSafety::test_auto_approve_mode_is_yolo 
tests/test_modes.py::TestModeSafety::test_plan_mode_is_safe 
[gw10] [ 49%] PASSED tests/test_modes.py::TestModeSafety::test_plan_mode_is_safe 
tests/test_modes.py::TestModeSafety::test_accept_edits_mode_is_destructive 
[gw10] [ 49%] PASSED tests/test_modes.py::TestModeSafety::test_accept_edits_mode_is_destructive 
[gw8] [ 50%] PASSED tests/backend/test_backend.py::TestBackend::test_backend_complete_streaming_error[https://api.fireworks.ai-GenericBackend-response0] 
tests/test_modes.py::TestAgentMode::test_all_modes_have_configs 
tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_all_methods_fail 
[gw10] [ 50%] PASSED tests/test_modes.py::TestAgentMode::test_all_modes_have_configs 
tests/test_modes.py::TestAgentMode::test_display_name_property 
[gw10] [ 50%] PASSED tests/test_modes.py::TestAgentMode::test_display_name_property 
tests/test_modes.py::TestAgentMode::test_description_property 
[gw10] [ 50%] PASSED tests/test_modes.py::TestAgentMode::test_description_property 
tests/test_modes.py::TestAgentMode::test_auto_approve_property 
[gw10] [ 50%] PASSED tests/test_modes.py::TestAgentMode::test_auto_approve_property 
tests/test_modes.py::TestAgentMode::test_from_string_valid 
[gw8] [ 50%] PASSED tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_all_methods_fail 
[gw10] [ 51%] PASSED tests/test_modes.py::TestAgentMode::test_from_string_valid 
tests/test_modes.py::TestAgentMode::test_from_string_invalid 
tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_multiple_widgets 
[gw10] [ 51%] PASSED tests/test_modes.py::TestAgentMode::test_from_string_invalid 
tests/test_modes.py::TestModeConfigOverrides::test_default_mode_has_no_overrides 
[gw10] [ 51%] PASSED tests/test_modes.py::TestModeConfigOverrides::test_default_mode_has_no_overrides 
tests/test_modes.py::TestModeConfigOverrides::test_auto_approve_mode_has_no_overrides 
[gw10] [ 51%] PASSED tests/test_modes.py::TestModeConfigOverrides::test_auto_approve_mode_has_no_overrides 
tests/test_modes.py::TestModeConfigOverrides::test_plan_mode_restricts_tools 
[gw8] [ 51%] PASSED tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_multiple_widgets 
[gw10] [ 52%] PASSED tests/test_modes.py::TestModeConfigOverrides::test_plan_mode_restricts_tools 
tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_preview_shortening 
tests/test_modes.py::TestModeConfigOverrides::test_accept_edits_mode_sets_tool_permissions 
[gw10] [ 52%] PASSED tests/test_modes.py::TestModeConfigOverrides::test_accept_edits_mode_sets_tool_permissions 
tests/test_modes.py::TestModeCycling::test_get_mode_order_includes_all_modes 
[gw10] [ 52%] PASSED tests/test_modes.py::TestModeCycling::test_get_mode_order_includes_all_modes 
tests/test_modes.py::TestModeCycling::test_next_mode_cycles_through_all 
[gw8] [ 52%] PASSED tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_preview_shortening 
tests/cli/test_clipboard.py::test_copy_osc52_writes_correct_sequence 
[gw10] [ 52%] PASSED tests/test_modes.py::TestModeCycling::test_next_mode_cycles_through_all 
tests/test_modes.py::TestModeCycling::test_next_mode_wraps_around 
[gw10] [ 52%] PASSED tests/test_modes.py::TestModeCycling::test_next_mode_wraps_around 
tests/test_modes.py::TestModeConfig::test_mode_config_defaults 
[gw8] [ 53%] PASSED tests/cli/test_clipboard.py::test_copy_osc52_writes_correct_sequence 
[gw4] [ 53%] PASSED tests/autocompletion/test_ui_chat_autocompletion.py::test_pressing_tab_writes_selected_command_and_keeps_popup_visible 
tests/cli/test_clipboard.py::test_copy_osc52_with_tmux 
[gw10] [ 53%] PASSED tests/test_modes.py::TestModeConfig::test_mode_config_defaults 
tests/test_modes.py::TestModeConfig::test_mode_config_frozen 
tests/autocompletion/test_ui_chat_autocompletion.py::test_arrow_navigation_updates_selected_suggestion 
[gw10] [ 53%] PASSED tests/test_modes.py::TestModeConfig::test_mode_config_frozen 
[gw8] [ 53%] PASSED tests/cli/test_clipboard.py::test_copy_osc52_with_tmux 
tests/test_modes.py::TestAgentSwitchMode::test_switch_to_plan_mode_restricts_tools 
tests/cli/test_clipboard.py::test_copy_x11_clipboard 
[gw8] [ 54%] PASSED tests/cli/test_clipboard.py::test_copy_x11_clipboard 
tests/cli/test_clipboard.py::test_copy_wayland_clipboard 
[gw8] [ 54%] PASSED tests/cli/test_clipboard.py::test_copy_wayland_clipboard 
tests/cli/test_clipboard.py::test_get_copy_fns_no_system_tools 
[gw8] [ 54%] PASSED tests/cli/test_clipboard.py::test_get_copy_fns_no_system_tools 
tests/test_modes.py::TestAcceptEditsMode::test_accept_edits_mode_not_auto_approve 
[gw8] [ 54%] PASSED tests/test_modes.py::TestAcceptEditsMode::test_accept_edits_mode_not_auto_approve 
[gw0] [ 54%] PASSED tests/acp/test_acp.py::TestSessionUpdates::test_agent_message_chunk_structure 
tests/test_modes.py::TestAcceptEditsMode::test_accept_edits_mode_auto_approves_write_file 
tests/acp/test_acp.py::TestSessionUpdates::test_tool_call_update_structure 
[gw9] [ 54%] PASSED tests/test_cli_programmatic_preload.py::test_run_programmatic_preload_streaming_is_batched 
tests/test_cli_programmatic_preload.py::test_run_programmatic_ignores_system_messages_in_previous 
[gw8] [ 55%] PASSED tests/test_modes.py::TestAcceptEditsMode::test_accept_edits_mode_auto_approves_write_file 
tests/test_modes.py::TestAcceptEditsMode::test_accept_edits_mode_requires_approval_for_other_tools 
[gw10] [ 55%] PASSED tests/test_modes.py::TestAgentSwitchMode::test_switch_to_plan_mode_restricts_tools 
tests/test_modes.py::TestAgentSwitchMode::test_switch_from_plan_to_normal_restores_tools 
[gw8] [ 55%] PASSED tests/test_modes.py::TestAcceptEditsMode::test_accept_edits_mode_requires_approval_for_other_tools 
tests/test_modes.py::TestPlanModeToolRestriction::test_plan_mode_only_exposes_read_tools_to_llm 
[gw11] [ 55%] PASSED tests/test_agent_tool_call.py::test_tool_call_can_be_interrupted[keyboard_interrupt] 
tests/test_agent_tool_call.py::test_tool_call_can_be_interrupted[asyncio_cancelled] 
[gw9] [ 55%] PASSED tests/test_cli_programmatic_preload.py::test_run_programmatic_ignores_system_messages_in_previous 
tests/test_history_manager.py::test_history_manager_normalizes_loaded_entries_like_numbers_to_strings 
[gw9] [ 56%] PASSED tests/test_history_manager.py::test_history_manager_normalizes_loaded_entries_like_numbers_to_strings 
tests/test_history_manager.py::test_history_manager_retains_a_fixed_number_of_entries 
[gw9] [ 56%] PASSED tests/test_history_manager.py::test_history_manager_retains_a_fixed_number_of_entries 
tests/test_history_manager.py::test_history_manager_filters_invalid_and_duplicated_entries 
[gw9] [ 56%] PASSED tests/test_history_manager.py::test_history_manager_filters_invalid_and_duplicated_entries 
tests/test_reasoning_content.py::TestMistralMapperParseContent::test_parse_content_multiple_thinking_chunks_concatenates 
[gw9] [ 56%] PASSED tests/test_reasoning_content.py::TestMistralMapperParseContent::test_parse_content_multiple_thinking_chunks_concatenates 
tests/test_reasoning_content.py::TestMistralMapperParseContent::test_parse_content_thinking_only_returns_empty_content 
[gw9] [ 56%] PASSED tests/test_reasoning_content.py::TestMistralMapperParseContent::test_parse_content_thinking_only_returns_empty_content 
tests/test_reasoning_content.py::TestMistralMapperParseContent::test_parse_content_empty_list_returns_empty 
[gw8] [ 56%] PASSED tests/test_modes.py::TestPlanModeToolRestriction::test_plan_mode_only_exposes_read_tools_to_llm 
tests/test_modes.py::TestPlanModeToolRestriction::test_plan_mode_rejects_non_plan_tool_call 
[gw9] [ 57%] PASSED tests/test_reasoning_content.py::TestMistralMapperParseContent::test_parse_content_empty_list_returns_empty 
tests/test_reasoning_content.py::TestMistralMapperPrepareMessage::test_prepare_assistant_message_without_reasoning 
[gw9] [ 57%] PASSED tests/test_reasoning_content.py::TestMistralMapperPrepareMessage::test_prepare_assistant_message_without_reasoning 
tests/test_reasoning_content.py::TestMistralMapperPrepareMessage::test_prepare_assistant_message_with_reasoning_creates_chunks 
[gw9] [ 57%] PASSED tests/test_reasoning_content.py::TestMistralMapperPrepareMessage::test_prepare_assistant_message_with_reasoning_creates_chunks 
[gw10] [ 57%] PASSED tests/test_modes.py::TestAgentSwitchMode::test_switch_from_plan_to_normal_restores_tools 
tests/test_reasoning_content.py::TestMistralMapperPrepareMessage::test_prepare_assistant_message_with_reasoning_and_none_content 
tests/test_modes.py::TestAgentSwitchMode::test_switch_mode_preserves_conversation_history 
[gw9] [ 57%] PASSED tests/test_reasoning_content.py::TestMistralMapperPrepareMessage::test_prepare_assistant_message_with_reasoning_and_none_content 
tests/test_reasoning_content.py::TestGenericBackendReasoningContent::test_complete_extracts_reasoning_content 
[gw11] [ 58%] PASSED tests/test_agent_tool_call.py::test_tool_call_can_be_interrupted[asyncio_cancelled] 
tests/test_history_manager.py::test_history_manager_filters_commands 
[gw11] [ 58%] PASSED tests/test_history_manager.py::test_history_manager_filters_commands 
tests/test_history_manager.py::test_history_manager_allows_navigation_round_trip 
[gw11] [ 58%] PASSED tests/test_history_manager.py::test_history_manager_allows_navigation_round_trip 
tests/test_history_manager.py::test_history_manager_prefix_filtering 
[gw11] [ 58%] PASSED tests/test_history_manager.py::test_history_manager_prefix_filtering 
tests/test_middleware.py::TestPlanModeMiddleware::test_injects_reminder_when_plan_mode_active 
[gw11] [ 58%] PASSED tests/test_middleware.py::TestPlanModeMiddleware::test_injects_reminder_when_plan_mode_active 
tests/test_middleware.py::TestPlanModeMiddleware::test_does_not_inject_when_default_mode 
[gw11] [ 58%] PASSED tests/test_middleware.py::TestPlanModeMiddleware::test_does_not_inject_when_default_mode 
tests/test_reasoning_content.py::TestLLMMessageReasoningContent::test_llm_message_from_dict_with_reasoning_content 
[gw11] [ 59%] PASSED tests/test_reasoning_content.py::TestLLMMessageReasoningContent::test_llm_message_from_dict_with_reasoning_content 
tests/test_reasoning_content.py::TestLLMMessageReasoningContent::test_llm_message_model_dump_includes_reasoning_content 
[gw11] [ 59%] PASSED tests/test_reasoning_content.py::TestLLMMessageReasoningContent::test_llm_message_model_dump_includes_reasoning_content 
tests/test_reasoning_content.py::TestLLMMessageReasoningContent::test_llm_message_model_dump_excludes_none_reasoning_content 
[gw11] [ 59%] PASSED tests/test_reasoning_content.py::TestLLMMessageReasoningContent::test_llm_message_model_dump_excludes_none_reasoning_content 
tests/test_reasoning_content.py::TestReasoningFieldNameConversion::test_reasoning_to_api_keeps_default_field 
[gw11] [ 59%] PASSED tests/test_reasoning_content.py::TestReasoningFieldNameConversion::test_reasoning_to_api_keeps_default_field 
tests/test_reasoning_content.py::TestReasoningFieldNameConversion::test_reasoning_to_api_renames_to_custom_field 
[gw11] [ 59%] PASSED tests/test_reasoning_content.py::TestReasoningFieldNameConversion::test_reasoning_to_api_renames_to_custom_field 
tests/test_reasoning_content.py::TestReasoningFieldNameConversion::test_reasoning_from_api_converts_custom_field 
[gw11] [ 60%] PASSED tests/test_reasoning_content.py::TestReasoningFieldNameConversion::test_reasoning_from_api_converts_custom_field 
[gw8] [ 60%] PASSED tests/test_modes.py::TestPlanModeToolRestriction::test_plan_mode_rejects_non_plan_tool_call 
tests/test_reasoning_content.py::TestReasoningFieldNameConversion::test_reasoning_from_api_keeps_default_field 
tests/test_reasoning_content.py::TestMistralMapperParseContent::test_parse_content_string_returns_content_only 
[gw11] [ 60%] PASSED tests/test_reasoning_content.py::TestReasoningFieldNameConversion::test_reasoning_from_api_keeps_default_field 
tests/test_reasoning_content.py::TestReasoningFieldNameConversion::test_complete_with_custom_reasoning_field_name 
[gw8] [ 60%] PASSED tests/test_reasoning_content.py::TestMistralMapperParseContent::test_parse_content_string_returns_content_only 
tests/test_reasoning_content.py::TestMistralMapperParseContent::test_parse_content_text_chunk_returns_content_only 
[gw8] [ 60%] PASSED tests/test_reasoning_content.py::TestMistralMapperParseContent::test_parse_content_text_chunk_returns_content_only 
tests/test_reasoning_content.py::TestMistralMapperParseContent::test_parse_content_thinking_chunk_extracts_reasoning 
[gw8] [ 60%] PASSED tests/test_reasoning_content.py::TestMistralMapperParseContent::test_parse_content_thinking_chunk_extracts_reasoning 
tests/test_tagged_text.py::test_tagged_text_creation_without_tag 
[gw8] [ 61%] PASSED tests/test_tagged_text.py::test_tagged_text_creation_without_tag 
tests/test_tagged_text.py::test_tagged_text_creation_with_tag 
[gw8] [ 61%] PASSED tests/test_tagged_text.py::test_tagged_text_creation_with_tag 
tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag[user_cancellation] 
[gw8] [ 61%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag[user_cancellation] 
tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag[tool_error] 
[gw9] [ 61%] PASSED tests/test_reasoning_content.py::TestGenericBackendReasoningContent::test_complete_extracts_reasoning_content 
[gw8] [ 61%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag[tool_error] 
tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag[vibe_stop_event] 
tests/test_reasoning_content.py::TestGenericBackendReasoningContent::test_complete_streaming_extracts_reasoning_content 
[gw8] [ 62%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag[vibe_stop_event] 
tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag[vibe_warning] 
[gw8] [ 62%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag[vibe_warning] 
tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_multiline[user_cancellation] 
[gw8] [ 62%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_multiline[user_cancellation] 
tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_multiline[tool_error] 
[gw8] [ 62%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_multiline[tool_error] 
tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_multiline[vibe_stop_event] 
[gw8] [ 62%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_multiline[vibe_stop_event] 
tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_multiline[vibe_warning] 
[gw8] [ 62%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_multiline[vibe_warning] 
tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_whitespace[user_cancellation] 
[gw8] [ 63%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_whitespace[user_cancellation] 
tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_whitespace[tool_error] 
[gw8] [ 63%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_whitespace[tool_error] 
tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_whitespace[vibe_stop_event] 
[gw8] [ 63%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_whitespace[vibe_stop_event] 
tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_whitespace[vibe_warning] 
[gw8] [ 63%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_known_tag_whitespace[vibe_warning] 
tests/test_tagged_text.py::test_tagged_text_from_string_with_unknown_tag 
[gw8] [ 63%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_unknown_tag 
tests/test_tagged_text.py::test_tagged_text_from_string_with_text_before_tag 
[gw8] [ 64%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_text_before_tag 
tests/test_tagged_text.py::test_tagged_text_from_string_with_text_after_tag 
[gw10] [ 64%] PASSED tests/test_modes.py::TestAgentSwitchMode::test_switch_mode_preserves_conversation_history 
[gw8] [ 64%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_text_after_tag 
tests/test_modes.py::TestAgentSwitchMode::test_switch_to_same_mode_is_noop 
tests/test_tagged_text.py::test_tagged_text_from_string_with_text_before_and_after_tag 
[gw8] [ 64%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_with_text_before_and_after_tag 
tests/test_tagged_text.py::test_tagged_text_from_string_without_tags 
[gw8] [ 64%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_without_tags 
tests/test_tagged_text.py::test_tagged_text_from_string_empty 
[gw8] [ 64%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_empty 
tests/test_tagged_text.py::test_tagged_text_from_string_mismatched_tags 
[gw8] [ 65%] PASSED tests/test_tagged_text.py::test_tagged_text_from_string_mismatched_tags 
[gw11] [ 65%] PASSED tests/test_reasoning_content.py::TestReasoningFieldNameConversion::test_complete_with_custom_reasoning_field_name 
tests/test_tagged_text.py::test_tagged_text_round_trip 
[gw8] [ 65%] PASSED tests/test_tagged_text.py::test_tagged_text_round_trip 
tests/test_reasoning_content.py::TestReasoningFieldNameConversion::test_streaming_with_custom_reasoning_field_name 
tests/test_tagged_text.py::test_tagged_text_round_trip_no_tag 
[gw8] [ 65%] PASSED tests/test_tagged_text.py::test_tagged_text_round_trip_no_tag 
[gw9] [ 65%] PASSED tests/test_reasoning_content.py::TestGenericBackendReasoningContent::test_complete_streaming_extracts_reasoning_content 
tests/test_reasoning_content.py::TestAPIToolFormatHandlerReasoningContent::test_process_api_response_message_extracts_reasoning_content 
tests/test_ui_input_history.py::test_ui_navigation_through_input_history 
[gw9] [ 66%] PASSED tests/test_reasoning_content.py::TestAPIToolFormatHandlerReasoningContent::test_process_api_response_message_extracts_reasoning_content 
tests/test_reasoning_content.py::TestAPIToolFormatHandlerReasoningContent::test_process_api_response_message_handles_missing_reasoning_content 
[gw9] [ 66%] PASSED tests/test_reasoning_content.py::TestAPIToolFormatHandlerReasoningContent::test_process_api_response_message_handles_missing_reasoning_content 
tests/test_reasoning_content.py::TestAgentStreamingReasoningEvents::test_streaming_accumulates_reasoning_in_message 
[gw10] [ 66%] PASSED tests/test_modes.py::TestAgentSwitchMode::test_switch_to_same_mode_is_noop 
tests/test_modes.py::TestAcceptEditsMode::test_accept_edits_config_sets_write_file_always 
[gw10] [ 66%] PASSED tests/test_modes.py::TestAcceptEditsMode::test_accept_edits_config_sets_write_file_always 
tests/test_modes.py::TestAcceptEditsMode::test_accept_edits_config_sets_search_replace_always 
[gw10] [ 66%] PASSED tests/test_modes.py::TestAcceptEditsMode::test_accept_edits_config_sets_search_replace_always 
tests/test_ui_pending_user_message.py::test_shows_user_message_as_pending_until_agent_is_initialized 
[gw11] [ 66%] PASSED tests/test_reasoning_content.py::TestReasoningFieldNameConversion::test_streaming_with_custom_reasoning_field_name 
tests/test_reasoning_content.py::TestMistralReasoningFieldNameValidation::test_mistral_backend_rejects_custom_reasoning_field_name 
[gw11] [ 67%] PASSED tests/test_reasoning_content.py::TestMistralReasoningFieldNameValidation::test_mistral_backend_rejects_custom_reasoning_field_name 
tests/test_reasoning_content.py::TestMistralReasoningFieldNameValidation::test_mistral_backend_accepts_default_reasoning_field_name 
[gw11] [ 67%] PASSED tests/test_reasoning_content.py::TestMistralReasoningFieldNameValidation::test_mistral_backend_accepts_default_reasoning_field_name 
tests/test_system_prompt.py::test_get_universal_system_prompt_includes_windows_prompt_on_windows 
[gw6] [ 67%] PASSED tests/acp/test_bash.py::TestAcpBashTimeout::test_run_timeout_handles_kill_failure 
tests/acp/test_bash.py::TestAcpBashEmbedding::test_run_with_embedding 
[gw9] [ 67%] PASSED tests/test_reasoning_content.py::TestAgentStreamingReasoningEvents::test_streaming_accumulates_reasoning_in_message 
tests/test_reasoning_content.py::TestAgentStreamingReasoningEvents::test_streaming_content_only_no_reasoning 
[gw6] [ 67%] PASSED tests/acp/test_bash.py::TestAcpBashEmbedding::test_run_with_embedding 
tests/acp/test_bash.py::TestAcpBashEmbedding::test_run_embedding_without_tool_call_id 
[gw11] [ 67%] PASSED tests/test_system_prompt.py::test_get_universal_system_prompt_includes_windows_prompt_on_windows 
tests/tools/test_bash.py::test_runs_echo_successfully 
[gw6] [ 68%] PASSED tests/acp/test_bash.py::TestAcpBashEmbedding::test_run_embedding_without_tool_call_id 
tests/acp/test_bash.py::TestAcpBashEmbedding::test_run_embedding_handles_exception 
[gw11] [ 68%] PASSED tests/tools/test_bash.py::test_runs_echo_successfully 
tests/tools/test_bash.py::test_fails_cat_command_with_missing_file 
[gw11] [ 68%] PASSED tests/tools/test_bash.py::test_fails_cat_command_with_missing_file 
tests/tools/test_bash.py::test_uses_effective_workdir 
[gw11] [ 68%] PASSED tests/tools/test_bash.py::test_uses_effective_workdir 
tests/tools/test_bash.py::test_check_allowlist_denylist 
[gw11] [ 68%] PASSED tests/tools/test_bash.py::test_check_allowlist_denylist 
tests/tools/test_grep.py::test_detects_ripgrep_when_available 
[gw11] [ 69%] PASSED tests/tools/test_grep.py::test_detects_ripgrep_when_available 
tests/tools/test_grep.py::test_falls_back_to_gnu_grep 
[gw6] [ 69%] PASSED tests/acp/test_bash.py::TestAcpBashEmbedding::test_run_embedding_handles_exception 
[gw11] [ 69%] PASSED tests/tools/test_grep.py::test_falls_back_to_gnu_grep 
tests/tools/test_grep.py::test_raises_error_if_no_grep_available 
tests/acp/test_bash.py::TestAcpBashConfig::test_run_uses_config_default_timeout 
[gw11] [ 69%] PASSED tests/tools/test_grep.py::test_raises_error_if_no_grep_available 
tests/tools/test_grep.py::test_finds_pattern_in_file 
[gw11] [ 69%] PASSED tests/tools/test_grep.py::test_finds_pattern_in_file 
tests/tools/test_grep.py::test_finds_multiple_matches 
[gw6] [ 69%] PASSED tests/acp/test_bash.py::TestAcpBashConfig::test_run_uses_config_default_timeout 
[gw11] [ 70%] PASSED tests/tools/test_grep.py::test_finds_multiple_matches 
tests/acp/test_bash.py::TestAcpBashCleanup::test_run_releases_terminal_on_success 
tests/tools/test_grep.py::test_returns_empty_on_no_matches 
[gw11] [ 70%] PASSED tests/tools/test_grep.py::test_returns_empty_on_no_matches 
tests/tools/test_grep.py::test_fails_with_empty_pattern 
[gw11] [ 70%] PASSED tests/tools/test_grep.py::test_fails_with_empty_pattern 
tests/tools/test_grep.py::test_fails_with_nonexistent_path 
[gw11] [ 70%] PASSED tests/tools/test_grep.py::test_fails_with_nonexistent_path 
tests/tools/test_grep.py::test_searches_in_specific_path 
[gw6] [ 70%] PASSED tests/acp/test_bash.py::TestAcpBashCleanup::test_run_releases_terminal_on_success 
[gw9] [ 71%] PASSED tests/test_reasoning_content.py::TestAgentStreamingReasoningEvents::test_streaming_content_only_no_reasoning 
tests/acp/test_bash.py::TestAcpBashCleanup::test_run_releases_terminal_on_timeout 
tests/tools/test_bash.py::test_handles_timeout 
[gw11] [ 71%] PASSED tests/tools/test_grep.py::test_searches_in_specific_path 
tests/tools/test_grep.py::test_truncates_to_max_matches 
[gw11] [ 71%] PASSED tests/tools/test_grep.py::test_truncates_to_max_matches 
tests/tools/test_grep.py::test_truncates_to_max_output_bytes 
[gw11] [ 71%] PASSED tests/tools/test_grep.py::test_truncates_to_max_output_bytes 
tests/tools/test_grep.py::test_respects_default_ignore_patterns 
[gw11] [ 71%] PASSED tests/tools/test_grep.py::test_respects_default_ignore_patterns 
tests/tools/test_grep.py::test_respects_vibeignore_file 
[gw11] [ 71%] PASSED tests/tools/test_grep.py::test_respects_vibeignore_file 
tests/tools/test_grep.py::test_ignores_comments_in_vibeignore 
[gw11] [ 72%] PASSED tests/tools/test_grep.py::test_ignores_comments_in_vibeignore 
tests/tools/test_grep.py::test_tracks_search_history 
[gw11] [ 72%] PASSED tests/tools/test_grep.py::test_tracks_search_history 
tests/tools/test_grep.py::test_uses_effective_workdir 
[gw11] [ 72%] PASSED tests/tools/test_grep.py::test_uses_effective_workdir 
tests/tools/test_grep.py::TestGnuGrepBackend::test_finds_pattern_in_file 
[gw11] [ 72%] PASSED tests/tools/test_grep.py::TestGnuGrepBackend::test_finds_pattern_in_file 
tests/tools/test_grep.py::TestGnuGrepBackend::test_finds_multiple_matches 
[gw11] [ 72%] PASSED tests/tools/test_grep.py::TestGnuGrepBackend::test_finds_multiple_matches 
tests/tools/test_grep.py::TestGnuGrepBackend::test_returns_empty_on_no_matches 
[gw11] [ 73%] PASSED tests/tools/test_grep.py::TestGnuGrepBackend::test_returns_empty_on_no_matches 
tests/tools/test_grep.py::TestGnuGrepBackend::test_case_insensitive_for_lowercase_pattern 
[gw11] [ 73%] PASSED tests/tools/test_grep.py::TestGnuGrepBackend::test_case_insensitive_for_lowercase_pattern 
tests/tools/test_grep.py::TestGnuGrepBackend::test_case_sensitive_for_mixed_case_pattern 
[gw11] [ 73%] PASSED tests/tools/test_grep.py::TestGnuGrepBackend::test_case_sensitive_for_mixed_case_pattern 
tests/tools/test_grep.py::TestGnuGrepBackend::test_respects_exclude_patterns 
[gw11] [ 73%] PASSED tests/tools/test_grep.py::TestGnuGrepBackend::test_respects_exclude_patterns 
tests/tools/test_grep.py::TestGnuGrepBackend::test_searches_in_specific_path 
[gw11] [ 73%] PASSED tests/tools/test_grep.py::TestGnuGrepBackend::test_searches_in_specific_path 
tests/tools/test_grep.py::TestGnuGrepBackend::test_respects_vibeignore_file 
[gw11] [ 73%] PASSED tests/tools/test_grep.py::TestGnuGrepBackend::test_respects_vibeignore_file 
tests/tools/test_grep.py::TestGnuGrepBackend::test_truncates_to_max_matches 
[gw11] [ 74%] PASSED tests/tools/test_grep.py::TestGnuGrepBackend::test_truncates_to_max_matches 
tests/tools/test_grep.py::TestRipgrepBackend::test_smart_case_lowercase_pattern 
[gw1] [ 74%] FAILED tests/autocompletion/test_ui_chat_autocompletion.py::test_path_completion_popup_shows_up_to_ten_results 
tests/autocompletion/test_ui_chat_autocompletion.py::test_pressing_tab_writes_selected_path_name_and_hides_popup 
[gw11] [ 74%] PASSED tests/tools/test_grep.py::TestRipgrepBackend::test_smart_case_lowercase_pattern 
tests/tools/test_grep.py::TestRipgrepBackend::test_smart_case_mixed_case_pattern 
[gw11] [ 74%] PASSED tests/tools/test_grep.py::TestRipgrepBackend::test_smart_case_mixed_case_pattern 
tests/tools/test_grep.py::TestRipgrepBackend::test_searches_ignored_files_when_use_default_ignore_false 
[gw11] [ 74%] PASSED tests/tools/test_grep.py::TestRipgrepBackend::test_searches_ignored_files_when_use_default_ignore_false 
tests/tools/test_manager_get_tool_config.py::test_returns_default_config_when_no_overrides 
[gw11] [ 75%] PASSED tests/tools/test_manager_get_tool_config.py::test_returns_default_config_when_no_overrides 
tests/tools/test_manager_get_tool_config.py::test_merges_user_overrides_with_defaults 
[gw11] [ 75%] PASSED tests/tools/test_manager_get_tool_config.py::test_merges_user_overrides_with_defaults 
tests/tools/test_manager_get_tool_config.py::test_preserves_tool_specific_fields_from_overrides 
[gw11] [ 75%] PASSED tests/tools/test_manager_get_tool_config.py::test_preserves_tool_specific_fields_from_overrides 
tests/tools/test_manager_get_tool_config.py::test_falls_back_to_base_config_for_unknown_tool 
[gw5] [ 75%] PASSED tests/autocompletion/test_file_indexer.py::test_updates_index_on_file_rename 
[gw10] [ 75%] PASSED tests/test_ui_pending_user_message.py::test_shows_user_message_as_pending_until_agent_is_initialized 
tests/test_ui_pending_user_message.py::test_can_interrupt_pending_message_during_initialization 
tests/autocompletion/test_file_indexer.py::test_updates_index_on_folder_rename 
[gw4] [ 75%] PASSED tests/autocompletion/test_ui_chat_autocompletion.py::test_arrow_navigation_updates_selected_suggestion 
tests/autocompletion/test_ui_chat_autocompletion.py::test_arrow_navigation_cycles_through_suggestions 
[gw11] [ 76%] PASSED tests/tools/test_manager_get_tool_config.py::test_falls_back_to_base_config_for_unknown_tool 
tests/tools/test_manager_get_tool_config.py::test_applies_workdir_from_vibe_config 
[gw11] [ 76%] PASSED tests/tools/test_manager_get_tool_config.py::test_applies_workdir_from_vibe_config 
tests/tools/test_ui_bash_execution.py::test_ui_reports_no_output 
[gw11] [ 76%] PASSED tests/tools/test_ui_bash_execution.py::test_ui_reports_no_output 
tests/tools/test_ui_bash_execution.py::test_ui_shows_success_in_case_of_zero_code 
[gw7] [ 76%] FAILED tests/snapshots/test_ui_snapshot_reasoning_content.py::test_snapshot_buffered_reasoning_yields_before_content 
tests/snapshots/test_ui_snapshot_release_update_notification.py::test_snapshot_shows_release_update_notification 
[gw10] [ 76%] PASSED tests/test_ui_pending_user_message.py::test_can_interrupt_pending_message_during_initialization 
tests/test_ui_pending_user_message.py::test_retry_initialization_after_interrupt 
[gw8] [ 77%] PASSED tests/test_ui_input_history.py::test_ui_navigation_through_input_history 
tests/test_ui_input_history.py::test_ui_does_nothing_if_command_completion_is_active 
[gw3] [ 77%] FAILED tests/snapshots/test_ui_snapshot_basic_conversation.py::test_snapshot_shows_basic_conversation 
tests/snapshots/test_ui_snapshot_code_block_horizontal_scrolling.py::test_snapshot_allows_horizontal_scrolling_for_long_code_blocks 
[gw6] [ 77%] PASSED tests/acp/test_bash.py::TestAcpBashCleanup::test_run_releases_terminal_on_timeout 
[gw9] [ 77%] PASSED tests/tools/test_bash.py::test_handles_timeout 
tests/tools/test_bash.py::test_truncates_output_to_max_bytes 
tests/acp/test_bash.py::TestAcpBashCleanup::test_run_handles_release_failure 
[gw9] [ 77%] PASSED tests/tools/test_bash.py::test_truncates_output_to_max_bytes 
tests/tools/test_bash.py::test_decodes_non_utf8_bytes 
[gw9] [ 77%] PASSED tests/tools/test_bash.py::test_decodes_non_utf8_bytes 
tests/tools/test_ui_bash_execution.py::test_ui_handles_utf8_output 
[gw6] [ 78%] PASSED tests/acp/test_bash.py::TestAcpBashCleanup::test_run_handles_release_failure 
tests/acp/test_content.py::TestACPContent::test_text_content 
[gw11] [ 78%] PASSED tests/tools/test_ui_bash_execution.py::test_ui_shows_success_in_case_of_zero_code 
tests/tools/test_ui_bash_execution.py::test_ui_shows_failure_in_case_of_non_zero_code 
[gw5] [ 78%] PASSED tests/autocompletion/test_file_indexer.py::test_updates_index_on_folder_rename 
[gw6] [ 78%] PASSED tests/acp/test_content.py::TestACPContent::test_text_content 
tests/update_notifier/test_filesystem_update_cache_repository.py::test_reads_cache_from_file_when_present 
[gw6] [ 78%] PASSED tests/update_notifier/test_filesystem_update_cache_repository.py::test_reads_cache_from_file_when_present 
tests/update_notifier/test_filesystem_update_cache_repository.py::test_returns_none_when_cache_file_is_corrupted 
[gw6] [ 79%] PASSED tests/update_notifier/test_filesystem_update_cache_repository.py::test_returns_none_when_cache_file_is_corrupted 
tests/update_notifier/test_filesystem_update_cache_repository.py::test_overwrites_existing_cache 
[gw6] [ 79%] PASSED tests/update_notifier/test_filesystem_update_cache_repository.py::test_overwrites_existing_cache 
tests/update_notifier/test_filesystem_update_cache_repository.py::test_silently_ignores_errors_when_writing_cache_fails 
[gw6] [ 79%] PASSED tests/update_notifier/test_filesystem_update_cache_repository.py::test_silently_ignores_errors_when_writing_cache_fails 
tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_latest_version_when_available 
[gw6] [ 79%] PASSED tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_latest_version_when_available 
tests/update_notifier/test_github_version_update_gateway.py::test_strips_uppercase_prefix_from_tag_name 
[gw6] [ 79%] PASSED tests/update_notifier/test_github_version_update_gateway.py::test_strips_uppercase_prefix_from_tag_name 
tests/update_notifier/test_github_version_update_gateway.py::test_considers_no_update_available_when_no_releases_are_found 
[gw6] [ 79%] PASSED tests/update_notifier/test_github_version_update_gateway.py::test_considers_no_update_available_when_no_releases_are_found 
tests/update_notifier/test_github_version_update_gateway.py::test_considers_no_update_available_when_only_drafts_and_prereleases_are_found 
[gw6] [ 80%] PASSED tests/update_notifier/test_github_version_update_gateway.py::test_considers_no_update_available_when_only_drafts_and_prereleases_are_found 
tests/update_notifier/test_github_version_update_gateway.py::test_picks_the_most_recently_published_non_prerelease_and_non_draft 
[gw6] [ 80%] PASSED tests/update_notifier/test_github_version_update_gateway.py::test_picks_the_most_recently_published_non_prerelease_and_non_draft 
tests/update_notifier/test_github_version_update_gateway.py::test_ignores_draft_releases_and_prereleases[payload0] 
[gw6] [ 80%] PASSED tests/update_notifier/test_github_version_update_gateway.py::test_ignores_draft_releases_and_prereleases[payload0] 
tests/update_notifier/test_github_version_update_gateway.py::test_ignores_draft_releases_and_prereleases[payload1] 
[gw6] [ 80%] PASSED tests/update_notifier/test_github_version_update_gateway.py::test_ignores_draft_releases_and_prereleases[payload1] 
tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[not_found] 
[gw6] [ 80%] PASSED tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[not_found] 
tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[rate_limit_header] 
[gw6] [ 81%] PASSED tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[rate_limit_header] 
tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[rate_limit_status] 
[gw4] [ 81%] PASSED tests/autocompletion/test_ui_chat_autocompletion.py::test_arrow_navigation_cycles_through_suggestions 
[gw6] [ 81%] PASSED tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[rate_limit_status] 
tests/autocompletion/test_ui_chat_autocompletion.py::test_pressing_enter_submits_selected_command_and_hides_popup 
tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[forbidden] 
[gw6] [ 81%] PASSED tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[forbidden] 
tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[error_response] 
[gw6] [ 81%] PASSED tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[error_response] 
tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[invalid_json] 
[gw6] [ 81%] PASSED tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[invalid_json] 
tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[request_error] 
[gw6] [ 82%] PASSED tests/update_notifier/test_github_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[request_error] 
tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_nothing_when_no_versions_are_available 
[gw6] [ 82%] PASSED tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_nothing_when_no_versions_are_available 
tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_the_latest_non_yanked_version 
[gw6] [ 82%] PASSED tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_the_latest_non_yanked_version 
tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_nothing_when_only_yanked_versions_are_available 
[gw6] [ 82%] PASSED tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_nothing_when_only_yanked_versions_are_available 
tests/update_notifier/test_pypi_version_update_gateway.py::test_does_not_match_versions_by_substring 
[gw6] [ 82%] PASSED tests/update_notifier/test_pypi_version_update_gateway.py::test_does_not_match_versions_by_substring 
tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[<lambda>-not_found-None] 
[gw6] [ 83%] PASSED tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[<lambda>-not_found-None] 
tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[<lambda>-forbidden-None] 
[gw6] [ 83%] PASSED tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[<lambda>-forbidden-None] 
tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[<lambda>-error_response-None] 
[gw6] [ 83%] PASSED tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[<lambda>-error_response-None] 
tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[<lambda>-invalid_response-None] 
tests/autocompletion/test_file_indexer.py::test_updates_index_incrementally_by_default 
[gw6] [ 83%] PASSED tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[<lambda>-invalid_response-None] 
tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[_raise_connect_timeout-request_failed-None] 
[gw6] [ 83%] PASSED tests/update_notifier/test_pypi_version_update_gateway.py::test_retrieves_nothing_when_fetching_update_fails[_raise_connect_timeout-request_failed-None] 
tests/update_notifier/test_ui_version_update_notification.py::test_ui_displays_update_notification 
[gw10] [ 83%] PASSED tests/test_ui_pending_user_message.py::test_retry_initialization_after_interrupt 
tests/tools/test_ui_bash_execution.py::test_ui_handles_non_utf8_output 
[gw8] [ 84%] PASSED tests/test_ui_input_history.py::test_ui_does_nothing_if_command_completion_is_active 
tests/test_ui_input_history.py::test_ui_does_not_prevent_arrow_down_to_move_cursor_to_bottom_lines 
[gw7] [ 84%] FAILED tests/snapshots/test_ui_snapshot_release_update_notification.py::test_snapshot_shows_release_update_notification 
tests/test_agent_auto_compact.py::test_auto_compact_triggers_and_batches_observer 
[gw1] [ 84%] PASSED tests/autocompletion/test_ui_chat_autocompletion.py::test_pressing_tab_writes_selected_path_name_and_hides_popup 
tests/autocompletion/test_ui_chat_autocompletion.py::test_pressing_enter_writes_selected_path_name_and_hides_popup 
[gw11] [ 84%] PASSED tests/tools/test_ui_bash_execution.py::test_ui_shows_failure_in_case_of_non_zero_code 
tests/update_notifier/test_filesystem_update_cache_repository.py::test_returns_none_when_cache_file_is_missing 
[gw11] [ 84%] PASSED tests/update_notifier/test_filesystem_update_cache_repository.py::test_returns_none_when_cache_file_is_missing 
[gw6] [ 84%] PASSED tests/update_notifier/test_ui_version_update_notification.py::test_ui_displays_update_notification 
tests/update_notifier/test_ui_version_update_notification.py::test_ui_does_not_invoke_gateway_nor_show_error_notification_when_update_checks_are_disabled 
tests/update_notifier/test_ui_version_update_notification.py::test_ui_does_not_display_update_notification_when_not_available 
[gw7] [ 85%] FAILED tests/test_agent_auto_compact.py::test_auto_compact_triggers_and_batches_observer 
tests/test_agent_backend.py::test_passes_x_affinity_header_when_asking_an_answer 
[gw7] [ 85%] PASSED tests/test_agent_backend.py::test_passes_x_affinity_header_when_asking_an_answer 
tests/test_agent_backend.py::test_passes_x_affinity_header_when_asking_an_answer_streaming 
[gw7] [ 85%] PASSED tests/test_agent_backend.py::test_passes_x_affinity_header_when_asking_an_answer_streaming 
tests/test_agent_backend.py::test_updates_tokens_stats_based_on_backend_response 
[gw10] [ 85%] PASSED tests/tools/test_ui_bash_execution.py::test_ui_handles_non_utf8_output 
tests/update_notifier/test_ui_version_update_notification.py::test_ui_displays_warning_toast_when_check_fails 
[gw9] [ 85%] PASSED tests/tools/test_ui_bash_execution.py::test_ui_handles_utf8_output 
tests/tools/test_ui_bash_execution.py::test_ui_handles_non_utf8_stderr 
[gw7] [ 86%] PASSED tests/test_agent_backend.py::test_updates_tokens_stats_based_on_backend_response 
tests/update_notifier/test_ui_version_update_notification.py::test_ui_does_show_toast_when_cache_entry_is_too_old 
[gw3] [ 86%] FAILED tests/snapshots/test_ui_snapshot_code_block_horizontal_scrolling.py::test_snapshot_allows_horizontal_scrolling_for_long_code_blocks 
tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_default_mode 
[gw11] [ 86%] PASSED tests/update_notifier/test_ui_version_update_notification.py::test_ui_does_not_invoke_gateway_nor_show_error_notification_when_update_checks_are_disabled 
tests/update_notifier/test_ui_version_update_notification.py::test_ui_does_not_invoke_gateway_nor_show_update_notification_when_update_checks_are_disabled 
[gw6] [ 86%] PASSED tests/update_notifier/test_ui_version_update_notification.py::test_ui_does_not_display_update_notification_when_not_available 
tests/update_notifier/test_ui_version_update_notification.py::test_ui_does_not_show_toast_when_update_is_known_in_recent_cache_already 
[gw9] [ 86%] PASSED tests/tools/test_ui_bash_execution.py::test_ui_handles_non_utf8_stderr 
tests/update_notifier/test_version_update_use_case.py::test_retrieves_nothing_when_the_current_version_is_the_latest 
[gw9] [ 86%] PASSED tests/update_notifier/test_version_update_use_case.py::test_retrieves_nothing_when_the_current_version_is_the_latest 
tests/update_notifier/test_version_update_use_case.py::test_replaces_hyphens_with_plus_signs_in_latest_version_to_conform_with_PEP_440 
[gw9] [ 87%] PASSED tests/update_notifier/test_version_update_use_case.py::test_replaces_hyphens_with_plus_signs_in_latest_version_to_conform_with_PEP_440 
tests/update_notifier/test_version_update_use_case.py::test_retrieves_nothing_when_current_version_is_invalid 
[gw9] [ 87%] PASSED tests/update_notifier/test_version_update_use_case.py::test_retrieves_nothing_when_current_version_is_invalid 
[gw5] [ 87%] PASSED tests/autocompletion/test_file_indexer.py::test_updates_index_incrementally_by_default 
tests/update_notifier/test_version_update_use_case.py::test_raises_version_update_error[too_many_requests-Rate limit exceeded] 
[gw9] [ 87%] PASSED tests/update_notifier/test_version_update_use_case.py::test_raises_version_update_error[too_many_requests-Rate limit exceeded] 
tests/update_notifier/test_version_update_use_case.py::test_raises_version_update_error[invalid_response-invalid response] 
[gw9] [ 87%] PASSED tests/update_notifier/test_version_update_use_case.py::test_raises_version_update_error[invalid_response-invalid response] 
tests/update_notifier/test_version_update_use_case.py::test_raises_version_update_error[not_found-Unable to fetch the releases. Please check your permissions.] 
[gw9] [ 88%] PASSED tests/update_notifier/test_version_update_use_case.py::test_raises_version_update_error[not_found-Unable to fetch the releases. Please check your permissions.] 
tests/update_notifier/test_version_update_use_case.py::test_raises_version_update_error[error_response-Unexpected response] 
[gw9] [ 88%] PASSED tests/update_notifier/test_version_update_use_case.py::test_raises_version_update_error[error_response-Unexpected response] 
tests/update_notifier/test_version_update_use_case.py::test_raises_version_update_error[request_failed-Network error] 
[gw9] [ 88%] PASSED tests/update_notifier/test_version_update_use_case.py::test_raises_version_update_error[request_failed-Network error] 
tests/update_notifier/test_version_update_use_case.py::test_notifies_and_updates_cache_when_repository_is_empty 
[gw9] [ 88%] PASSED tests/update_notifier/test_version_update_use_case.py::test_notifies_and_updates_cache_when_repository_is_empty 
tests/update_notifier/test_version_update_use_case.py::test_does_not_notify_when_an_available_update_has_been_recently_cached 
[gw9] [ 88%] PASSED tests/update_notifier/test_version_update_use_case.py::test_does_not_notify_when_an_available_update_has_been_recently_cached 
tests/update_notifier/test_version_update_use_case.py::test_retrieves_nothing_when_the_recently_cached_update_is_the_one_currently_in_use 
[gw9] [ 88%] PASSED tests/update_notifier/test_version_update_use_case.py::test_retrieves_nothing_when_the_recently_cached_update_is_the_one_currently_in_use 
[gw10] [ 89%] PASSED tests/update_notifier/test_ui_version_update_notification.py::test_ui_displays_warning_toast_when_check_fails 
tests/update_notifier/test_version_update_use_case.py::test_retrieves_fresh_update_and_notifies_and_updates_cache_when_cache_is_not_fresh 
tests/update_notifier/test_version_update_use_case.py::test_retrieves_the_latest_version_update_when_available 
[gw9] [ 89%] PASSED tests/update_notifier/test_version_update_use_case.py::test_retrieves_fresh_update_and_notifies_and_updates_cache_when_cache_is_not_fresh 
[gw10] [ 89%] PASSED tests/update_notifier/test_version_update_use_case.py::test_retrieves_the_latest_version_update_when_available 
tests/update_notifier/test_version_update_use_case.py::test_updates_cache_timestamp_with_current_version_when_no_update_is_available 
tests/update_notifier/test_version_update_use_case.py::test_updates_cache_timestamp_with_current_version_when_gateway_errors 
[gw9] [ 89%] PASSED tests/update_notifier/test_version_update_use_case.py::test_updates_cache_timestamp_with_current_version_when_no_update_is_available 
[gw10] [ 89%] PASSED tests/update_notifier/test_version_update_use_case.py::test_updates_cache_timestamp_with_current_version_when_gateway_errors 
[gw7] [ 90%] PASSED tests/update_notifier/test_ui_version_update_notification.py::test_ui_does_show_toast_when_cache_entry_is_too_old 
tests/update_notifier/test_version_update_use_case.py::test_retrieves_nothing_when_the_current_version_is_greater_than_the_latest 
[gw7] [ 90%] PASSED tests/update_notifier/test_version_update_use_case.py::test_retrieves_nothing_when_the_current_version_is_greater_than_the_latest 
tests/autocompletion/test_file_indexer.py::test_rebuilds_index_when_mass_change_threshold_is_exceeded 
[gw3] [ 90%] FAILED tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_default_mode 
tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_cycle_to_plan_mode 
[gw8] [ 90%] PASSED tests/test_ui_input_history.py::test_ui_does_not_prevent_arrow_down_to_move_cursor_to_bottom_lines 
tests/test_ui_input_history.py::test_ui_resumes_arrow_down_after_manual_move 
[gw4] [ 90%] PASSED tests/autocompletion/test_ui_chat_autocompletion.py::test_pressing_enter_submits_selected_command_and_hides_popup 
tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_no_notification[widgets0-no widgets] 
[gw4] [ 90%] PASSED tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_no_notification[widgets0-no widgets] 
tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_no_notification[widgets1-no selection] 
[gw4] [ 91%] PASSED tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_no_notification[widgets1-no selection] 
tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_no_notification[widgets2-widget without text_selection attr] 
[gw4] [ 91%] PASSED tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_no_notification[widgets2-widget without text_selection attr] 
tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_no_notification[widgets3-get_selection raises] 
[gw4] [ 91%] PASSED tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_no_notification[widgets3-get_selection raises] 
tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_no_notification[widgets4-empty result] 
[gw4] [ 91%] PASSED tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_no_notification[widgets4-empty result] 
tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_no_notification[widgets5-empty text] 
[gw4] [ 91%] PASSED tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_no_notification[widgets5-empty text] 
tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_success 
[gw4] [ 92%] PASSED tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_success 
tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_tries_all 
[gw4] [ 92%] PASSED tests/cli/test_clipboard.py::test_copy_selection_to_clipboard_tries_all 
[gw6] [ 92%] PASSED tests/update_notifier/test_ui_version_update_notification.py::test_ui_does_not_show_toast_when_update_is_known_in_recent_cache_already 
tests/update_notifier/test_version_update_use_case.py::test_retrieves_nothing_when_latest_version_is_invalid 
[gw6] [ 92%] PASSED tests/update_notifier/test_version_update_use_case.py::test_retrieves_nothing_when_latest_version_is_invalid 
[gw11] [ 92%] PASSED tests/update_notifier/test_ui_version_update_notification.py::test_ui_does_not_invoke_gateway_nor_show_update_notification_when_update_checks_are_disabled 
tests/update_notifier/test_version_update_use_case.py::test_retrieves_nothing_when_no_version_is_available 
[gw11] [ 92%] PASSED tests/update_notifier/test_version_update_use_case.py::test_retrieves_nothing_when_no_version_is_available 
[gw0] [ 93%] PASSED tests/acp/test_acp.py::TestSessionUpdates::test_tool_call_update_structure 
tests/acp/test_acp.py::TestToolCallStructure::test_tool_call_request_permission_structure 
[gw3] [ 93%] FAILED tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_cycle_to_plan_mode 
tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_cycle_to_accept_edits_mode 
[gw8] [ 93%] PASSED tests/test_ui_input_history.py::test_ui_resumes_arrow_down_after_manual_move 
[gw1] [ 93%] PASSED tests/autocompletion/test_ui_chat_autocompletion.py::test_pressing_enter_writes_selected_path_name_and_hides_popup 
tests/autocompletion/test_ui_chat_autocompletion.py::test_fuzzy_matches_subsequence_characters 
[gw5] [ 93%] PASSED tests/autocompletion/test_file_indexer.py::test_rebuilds_index_when_mass_change_threshold_is_exceeded 
tests/autocompletion/test_file_indexer.py::test_switching_between_roots_restarts_index 
[gw5] [ 94%] PASSED tests/autocompletion/test_file_indexer.py::test_switching_between_roots_restarts_index 
tests/autocompletion/test_file_indexer.py::test_watcher_failure_does_not_break_existing_index 
[gw5] [ 94%] PASSED tests/autocompletion/test_file_indexer.py::test_watcher_failure_does_not_break_existing_index 
tests/autocompletion/test_file_indexer.py::test_shutdown_cleans_up_resources 
[gw3] [ 94%] FAILED tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_cycle_to_accept_edits_mode 
tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_cycle_to_auto_approve_mode 
[gw5] [ 94%] PASSED tests/autocompletion/test_file_indexer.py::test_shutdown_cleans_up_resources 
tests/autocompletion/test_fuzzy.py::test_empty_pattern_matches_anything 
[gw5] [ 94%] PASSED tests/autocompletion/test_fuzzy.py::test_empty_pattern_matches_anything 
[gw2] [ 94%] PASSED tests/onboarding/test_ui_onboarding.py::test_ui_gets_through_the_onboarding_successfully 
tests/onboarding/test_ui_onboarding.py::test_ui_can_pick_a_theme_and_saves_selection 
[gw3] [ 95%] FAILED tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_cycle_to_auto_approve_mode 
tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_cycle_wraps_to_default 
[gw1] [ 95%] PASSED tests/autocompletion/test_ui_chat_autocompletion.py::test_fuzzy_matches_subsequence_characters 
tests/autocompletion/test_ui_chat_autocompletion.py::test_fuzzy_matches_word_boundaries 
[gw3] [ 95%] FAILED tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_cycle_wraps_to_default 
tests/snapshots/test_ui_snapshot_reasoning_content.py::test_snapshot_shows_reasoning_content 
[gw0] [ 95%] PASSED tests/acp/test_acp.py::TestToolCallStructure::test_tool_call_request_permission_structure 
tests/acp/test_acp.py::TestToolCallStructure::test_tool_call_update_approved_structure 
[gw1] [ 95%] PASSED tests/autocompletion/test_ui_chat_autocompletion.py::test_fuzzy_matches_word_boundaries 
tests/autocompletion/test_ui_chat_autocompletion.py::test_finds_files_recursively_by_filename 
[gw1] [ 96%] PASSED tests/autocompletion/test_ui_chat_autocompletion.py::test_finds_files_recursively_by_filename 
tests/autocompletion/test_ui_chat_autocompletion.py::test_finds_files_recursively_with_partial_path 
[gw3] [ 96%] FAILED tests/snapshots/test_ui_snapshot_reasoning_content.py::test_snapshot_shows_reasoning_content 
tests/snapshots/test_ui_snapshot_reasoning_content.py::test_snapshot_shows_reasoning_content_expanded 
[gw1] [ 96%] PASSED tests/autocompletion/test_ui_chat_autocompletion.py::test_finds_files_recursively_with_partial_path 
tests/autocompletion/test_ui_chat_autocompletion.py::test_does_not_trigger_completion_when_navigating_history 
[gw2] [ 96%] PASSED tests/onboarding/test_ui_onboarding.py::test_ui_can_pick_a_theme_and_saves_selection 
tests/skills/test_manager.py::TestSkillManagerDiscovery::test_discovers_no_skills_when_directory_empty 
[gw2] [ 96%] PASSED tests/skills/test_manager.py::TestSkillManagerDiscovery::test_discovers_no_skills_when_directory_empty 
tests/skills/test_manager.py::TestSkillManagerDiscovery::test_discovers_skill_from_skill_paths 
[gw2] [ 96%] PASSED tests/skills/test_manager.py::TestSkillManagerDiscovery::test_discovers_skill_from_skill_paths 
tests/skills/test_manager.py::TestSkillManagerDiscovery::test_discovers_multiple_skills 
[gw2] [ 97%] PASSED tests/skills/test_manager.py::TestSkillManagerDiscovery::test_discovers_multiple_skills 
tests/skills/test_manager.py::TestSkillManagerDiscovery::test_ignores_directories_without_skill_md 
[gw2] [ 97%] PASSED tests/skills/test_manager.py::TestSkillManagerDiscovery::test_ignores_directories_without_skill_md 
tests/skills/test_manager.py::TestSkillManagerDiscovery::test_ignores_files_in_skills_directory 
[gw2] [ 97%] PASSED tests/skills/test_manager.py::TestSkillManagerDiscovery::test_ignores_files_in_skills_directory 
tests/skills/test_manager.py::TestSkillManagerParsing::test_parses_all_skill_fields 
[gw2] [ 97%] PASSED tests/skills/test_manager.py::TestSkillManagerParsing::test_parses_all_skill_fields 
tests/skills/test_manager.py::TestSkillManagerParsing::test_sets_correct_skill_path 
[gw2] [ 97%] PASSED tests/skills/test_manager.py::TestSkillManagerParsing::test_sets_correct_skill_path 
tests/skills/test_manager.py::TestSkillManagerParsing::test_skips_skill_with_invalid_frontmatter 
[gw2] [ 98%] PASSED tests/skills/test_manager.py::TestSkillManagerParsing::test_skips_skill_with_invalid_frontmatter 
tests/skills/test_manager.py::TestSkillManagerParsing::test_skips_skill_with_missing_required_fields 
[gw2] [ 98%] PASSED tests/skills/test_manager.py::TestSkillManagerParsing::test_skips_skill_with_missing_required_fields 
[gw3] [ 98%] FAILED tests/snapshots/test_ui_snapshot_reasoning_content.py::test_snapshot_shows_reasoning_content_expanded 
tests/snapshots/test_ui_snapshot_reasoning_content.py::test_snapshot_shows_interleaved_reasoning 
[gw0] [ 98%] PASSED tests/acp/test_acp.py::TestToolCallStructure::test_tool_call_update_approved_structure 
tests/acp/test_acp.py::TestToolCallStructure::test_tool_call_update_rejected_structure 
[gw3] [ 98%] FAILED tests/snapshots/test_ui_snapshot_reasoning_content.py::test_snapshot_shows_interleaved_reasoning 
[gw1] [ 98%] PASSED tests/autocompletion/test_ui_chat_autocompletion.py::test_does_not_trigger_completion_when_navigating_history 
[gw0] [ 99%] PASSED tests/acp/test_acp.py::TestToolCallStructure::test_tool_call_update_rejected_structure 
tests/acp/test_acp.py::TestToolCallStructure::test_tool_call_in_progress_update_structure 
[gw0] [ 99%] SKIPPED tests/acp/test_acp.py::TestToolCallStructure::test_tool_call_in_progress_update_structure 
tests/acp/test_acp.py::TestToolCallStructure::test_tool_call_result_update_failure_structure 
[gw0] [ 99%] PASSED tests/acp/test_acp.py::TestToolCallStructure::test_tool_call_result_update_failure_structure 
tests/acp/test_acp.py::TestCancellationStructure::test_tool_call_update_cancelled_structure 
[gw0] [ 99%] SKIPPED tests/acp/test_acp.py::TestCancellationStructure::test_tool_call_update_cancelled_structure 
tests/acp/test_bash.py::TestAcpBashBasic::test_get_name 
[gw0] [ 99%] PASSED tests/acp/test_bash.py::TestAcpBashBasic::test_get_name 
tests/acp/test_bash.py::TestAcpBashBasic::test_get_summary_simple_command 
[gw0] [100%] PASSED tests/acp/test_bash.py::TestAcpBashBasic::test_get_summary_simple_command 

=================================== FAILURES ===================================
_____________ test_finds_files_when_pattern_matches_directory_name _____________
[gw2] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

file_tree = PosixPath('/tmp/pytest-of-rowen/pytest-36/popen-gw2/test_finds_files_when_pattern_0')

    def test_finds_files_when_pattern_matches_directory_name(file_tree: Path) -> None:
        results = PathCompleter().get_completions("@acp", cursor_pos=4)
    
>       assert results == [
            "@vibe/acp/",
            "@vibe/acp/agent.py",
            "@vibe/acp/entrypoint.py",
            "@vibe/cli/autocompletion/completers.py",
            "@tests/autocompletion/",
            "@tests/autocompletion/test_fuzzy.py",
            "@vibe/cli/autocompletion/",
            "@vibe/cli/autocompletion/fuzzy.py",
        ]
E       AssertionError: assert ['@vibe/acp/', '@vibe/acp/agent.py', '@vibe/acp/entrypoint.py', '@vibe/cli/autocompletion/completers.py', '@tests/autocompletion/', '@vibe/cli/autocompletion/', '@tests/autocompletion/test_fuzzy.py', '@vibe/cli/autocompletion/fuzzy.py'] == ['@vibe/acp/', '@vibe/acp/agent.py', '@vibe/acp/entrypoint.py', '@vibe/cli/autocompletion/completers.py', '@tests/autocompletion/', '@tests/autocompletion/test_fuzzy.py', '@vibe/cli/autocompletion/', '@vibe/cli/autocompletion/fuzzy.py']
E         
E         At index 5 diff: '@vibe/cli/autocompletion/' != '@tests/autocompletion/test_fuzzy.py'
E         
E         Full diff:
E           [
E               '@vibe/acp/',
E               '@vibe/acp/agent.py',
E               '@vibe/acp/entrypoint.py',
E               '@vibe/cli/autocompletion/completers.py',
E               '@tests/autocompletion/',
E         +     '@vibe/cli/autocompletion/',
E               '@tests/autocompletion/test_fuzzy.py',
E         -     '@vibe/cli/autocompletion/',
E               '@vibe/cli/autocompletion/fuzzy.py',
E           ]

/home/rowen/github-branches/vibe/tests/autocompletion/test_path_completer_recursive.py:60: AssertionError
___________________________ test_lists_root_entries ____________________________
[gw2] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

file_tree = PosixPath('/tmp/pytest-of-rowen/pytest-36/popen-gw2/test_lists_root_entries0')

    def test_lists_root_entries(file_tree: Path) -> None:
        controller, view = make_controller()
    
        controller.on_text_changed("@", cursor_index=1)
    
        suggestions, selected = view.suggestions[-1]
        assert selected == 0
>       assert [alias for alias, _ in suggestions] == ["@README.md", "@src/"]
E       AssertionError: assert ['@src/', '@README.md'] == ['@README.md', '@src/']
E         
E         At index 0 diff: '@src/' != '@README.md'
E         
E         Full diff:
E           [
E         +     '@src/',
E               '@README.md',
E         -     '@src/',
E           ]

/home/rowen/github-branches/vibe/tests/autocompletion/test_path_completion_controller.py:70: AssertionError
__________ test_lists_nested_entries_when_prefixing_with_folder_name ___________
[gw2] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

file_tree = PosixPath('/tmp/pytest-of-rowen/pytest-36/popen-gw2/test_lists_nested_entries_when0')

    def test_lists_nested_entries_when_prefixing_with_folder_name(file_tree: Path) -> None:
        controller, view = make_controller()
    
        controller.on_text_changed("@src/", cursor_index=5)
    
        suggestions, _ = view.suggestions[-1]
>       assert [alias for alias, _ in suggestions] == [
            "@src/core/",
            "@src/main.py",
            "@src/utils/",
        ]
E       AssertionError: assert ['@src/core/', '@src/utils/', '@src/main.py'] == ['@src/core/', '@src/main.py', '@src/utils/']
E         
E         At index 1 diff: '@src/utils/' != '@src/main.py'
E         
E         Full diff:
E           [
E               '@src/core/',
E         +     '@src/utils/',
E               '@src/main.py',
E         -     '@src/utils/',
E           ]

/home/rowen/github-branches/vibe/tests/autocompletion/test_path_completion_controller.py:88: AssertionError
______________ test_applies_selected_completion_on_enter_keycode _______________
[gw2] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

file_tree = PosixPath('/tmp/pytest-of-rowen/pytest-36/popen-gw2/test_applies_selected_completi1')

    def test_applies_selected_completion_on_enter_keycode(file_tree: Path) -> None:
        controller, view = make_controller()
        controller.on_text_changed("@src/", cursor_index=5)
        controller.on_key(events.Key("down", None), "@src/", 5)
    
        result = controller.on_key(events.Key("enter", None), "@src/", 5)
    
        assert result is CompletionResult.HANDLED
>       assert view.replacements == [(0, 5, "@src/main.py")]
E       AssertionError: assert [(0, 5, '@src/utils/')] == [(0, 5, '@src/main.py')]
E         
E         At index 0 diff: (0, 5, '@src/utils/') != (0, 5, '@src/main.py')
E         
E         Full diff:
E           [
E               (
E                   0,
E                   5,
E         -         '@src/main.py',
E         ?               ^^ ^^^^
E         +         '@src/utils/',
E         ?               ^^ ^^^
E               ),
E           ]

/home/rowen/github-branches/vibe/tests/autocompletion/test_path_completion_controller.py:128: AssertionError
_________________ test_navigates_and_cycles_across_suggestions _________________
[gw2] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

file_tree = PosixPath('/tmp/pytest-of-rowen/pytest-36/popen-gw2/test_navigates_and_cycles_acro0')

    def test_navigates_and_cycles_across_suggestions(file_tree: Path) -> None:
        controller, view = make_controller()
    
        controller.on_text_changed("@src/", cursor_index=5)
        controller.on_key(events.Key("down", None), "@src/", 5)
        suggestions, selected_index = view.suggestions[-1]
>       assert [alias for alias, _ in suggestions] == [
            "@src/core/",
            "@src/main.py",
            "@src/utils/",
        ]
E       AssertionError: assert ['@src/core/', '@src/utils/', '@src/main.py'] == ['@src/core/', '@src/main.py', '@src/utils/']
E         
E         At index 1 diff: '@src/utils/' != '@src/main.py'
E         
E         Full diff:
E           [
E               '@src/core/',
E         +     '@src/utils/',
E               '@src/main.py',
E         -     '@src/utils/',
E           ]

/home/rowen/github-branches/vibe/tests/autocompletion/test_path_completion_controller.py:138: AssertionError
________________________ test_limits_suggestions_to_ten ________________________
[gw2] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

file_tree = PosixPath('/tmp/pytest-of-rowen/pytest-36/popen-gw2/test_limits_suggestions_to_ten0')

    def test_limits_suggestions_to_ten(file_tree: Path) -> None:
        (file_tree / "src" / "core" / "extra").mkdir(parents=True)
        [
            (file_tree / "src" / "core" / "extra" / f"extra_file_{i}.py").write_text(
                "", encoding="utf-8"
            )
            for i in range(1, 13)
        ]
        controller, view = make_controller()
    
        controller.on_text_changed("@src/core/extra/", cursor_index=16)
        suggestions, selected_index = view.suggestions[-1]
        assert len(suggestions) == 10
>       assert [alias for alias, _ in suggestions] == [
            "@src/core/extra/extra_file_1.py",
            "@src/core/extra/extra_file_10.py",
            "@src/core/extra/extra_file_11.py",
            "@src/core/extra/extra_file_12.py",
            "@src/core/extra/extra_file_2.py",
            "@src/core/extra/extra_file_3.py",
            "@src/core/extra/extra_file_4.py",
            "@src/core/extra/extra_file_5.py",
            "@src/core/extra/extra_file_6.py",
            "@src/core/extra/extra_file_7.py",
        ]
E       AssertionError: assert ['@src/core/extra/extra_file_1.py', '@src/core/extra/extra_file_2.py', '@src/core/extra/extra_file_3.py', '@src/core/extra/extra_file_4.py', '@src/core/extra/extra_file_5.py', '@src/core/extra/extra_file_6.py', '@src/core/extra/extra_file_7.py', '@src/core/extra/extra_file_8.py', '@src/core/extra/extra_file_9.py', '@src/core/extra/extra_file_10.py'] == ['@src/core/extra/extra_file_1.py', '@src/core/extra/extra_file_10.py', '@src/core/extra/extra_file_11.py', '@src/core/extra/extra_file_12.py', '@src/core/extra/extra_file_2.py', '@src/core/extra/extra_file_3.py', '@src/core/extra/extra_file_4.py', '@src/core/extra/extra_file_5.py', '@src/core/extra/extra_file_6.py', '@src/core/extra/extra_file_7.py']
E         
E         At index 1 diff: '@src/core/extra/extra_file_2.py' != '@src/core/extra/extra_file_10.py'
E         
E         Full diff:
E           [
E               '@src/core/extra/extra_file_1.py',
E         -     '@src/core/extra/extra_file_10.py',
E         -     '@src/core/extra/extra_file_11.py',
E         -     '@src/core/extra/extra_file_12.py',
E               '@src/core/extra/extra_file_2.py',
E               '@src/core/extra/extra_file_3.py',
E               '@src/core/extra/extra_file_4.py',
E               '@src/core/extra/extra_file_5.py',
E               '@src/core/extra/extra_file_6.py',
E               '@src/core/extra/extra_file_7.py',
E         +     '@src/core/extra/extra_file_8.py',
E         +     '@src/core/extra/extra_file_9.py',
E         +     '@src/core/extra/extra_file_10.py',
E           ]

/home/rowen/github-branches/vibe/tests/autocompletion/test_path_completion_controller.py:171: AssertionError
______________________ TestACPInitialize.test_initialize _______________________
[gw7] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

self = <tests.acp.test_initialize.TestACPInitialize object at 0x7fbe86743590>
acp_agent = <vibe.acp.acp_agent.VibeAcpAgent object at 0x7fbe84a73d40>

    @pytest.mark.asyncio
    async def test_initialize(self, acp_agent: VibeAcpAgent) -> None:
        """Test regular initialize without terminal-auth capabilities."""
        request = InitializeRequest(protocolVersion=PROTOCOL_VERSION)
        response = await acp_agent.initialize(request)
    
        assert response.protocolVersion == PROTOCOL_VERSION
        assert response.agentCapabilities == AgentCapabilities(
            loadSession=False,
            promptCapabilities=PromptCapabilities(
                audio=False, embeddedContext=True, image=False
            ),
        )
>       assert response.agentInfo == Implementation(
            name="@mistralai/mistral-vibe", title="Mistral Vibe", version="1.3.5"
        )
E       AssertionError: assert Implementation(name='@l3afyb0y/porker-vibe', title='Porker Vibe', version='1.4.0') == Implementation(name='@mistralai/mistral-vibe', title='Mistral Vibe', version='1.3.5')
E         
E         Full diff:
E         - Implementation(name='@mistralai/mistral-vibe', title='Mistral Vibe', version='1.3.5')
E         + Implementation(name='@l3afyb0y/porker-vibe', title='Porker Vibe', version='1.4.0')

/home/rowen/github-branches/vibe/tests/acp/test_initialize.py:43: AssertionError
_____________ TestACPInitialize.test_initialize_with_terminal_auth _____________
[gw7] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

self = <tests.acp.test_initialize.TestACPInitialize object at 0x7fbe86743950>
acp_agent = <vibe.acp.acp_agent.VibeAcpAgent object at 0x7fbe85bb0830>

    @pytest.mark.asyncio
    async def test_initialize_with_terminal_auth(self, acp_agent: VibeAcpAgent) -> None:
        """Test initialize with terminal-auth capabilities to check it was included."""
        client_capabilities = ClientCapabilities(field_meta={"terminal-auth": True})
        request = InitializeRequest(
            protocolVersion=PROTOCOL_VERSION, clientCapabilities=client_capabilities
        )
        response = await acp_agent.initialize(request)
    
        assert response.protocolVersion == PROTOCOL_VERSION
        assert response.agentCapabilities == AgentCapabilities(
            loadSession=False,
            promptCapabilities=PromptCapabilities(
                audio=False, embeddedContext=True, image=False
            ),
        )
>       assert response.agentInfo == Implementation(
            name="@mistralai/mistral-vibe", title="Mistral Vibe", version="1.3.5"
        )
E       AssertionError: assert Implementation(name='@l3afyb0y/porker-vibe', title='Porker Vibe', version='1.4.0') == Implementation(name='@mistralai/mistral-vibe', title='Mistral Vibe', version='1.3.5')
E         
E         Full diff:
E         - Implementation(name='@mistralai/mistral-vibe', title='Mistral Vibe', version='1.3.5')
E         + Implementation(name='@l3afyb0y/porker-vibe', title='Porker Vibe', version='1.4.0')

/home/rowen/github-branches/vibe/tests/acp/test_initialize.py:65: AssertionError
___________ test_lists_immediate_children_when_path_ends_with_slash ____________
[gw9] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

file_tree = PosixPath('/tmp/pytest-of-rowen/pytest-36/popen-gw9/test_lists_immediate_children_0')

    def test_lists_immediate_children_when_path_ends_with_slash(file_tree: Path) -> None:
        controller, view = make_controller()
    
        controller.on_text_changed("@src/", cursor_index=5)
    
        suggestions, _ = view.suggestions[-1]
>       assert [alias for alias, _ in suggestions] == [
            "@src/core/",
            "@src/main.py",
            "@src/utils/",
        ]
E       AssertionError: assert ['@src/core/', '@src/utils/', '@src/main.py'] == ['@src/core/', '@src/main.py', '@src/utils/']
E         
E         At index 1 diff: '@src/utils/' != '@src/main.py'
E         
E         Full diff:
E           [
E               '@src/core/',
E         +     '@src/utils/',
E               '@src/main.py',
E         -     '@src/utils/',
E           ]

/home/rowen/github-branches/vibe/tests/autocompletion/test_path_completion_controller.py:218: AssertionError
______ TestACPNewSession.test_new_session_preserves_model_after_set_model ______
[gw7] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

self = <tests.acp.test_new_session.TestACPNewSession object at 0x7fbe86770ec0>
acp_agent = <vibe.acp.acp_agent.VibeAcpAgent object at 0x7fbe848faba0>

    @pytest.mark.asyncio
    async def test_new_session_preserves_model_after_set_model(
        self, acp_agent: VibeAcpAgent
    ) -> None:
        session_response = await acp_agent.newSession(
            NewSessionRequest(cwd=str(Path.cwd()), mcpServers=[])
        )
        session_id = session_response.sessionId
    
        assert session_response.models is not None
        assert session_response.models.currentModelId == "devstral-latest"
    
        response = await acp_agent.setSessionModel(
            SetSessionModelRequest(sessionId=session_id, modelId="devstral-small")
        )
        assert response is not None
    
        session_response = await acp_agent.newSession(
            NewSessionRequest(cwd=str(Path.cwd()), mcpServers=[])
        )
    
        assert session_response.models is not None
>       assert session_response.models.currentModelId == "devstral-small"
E       AssertionError: assert 'devstral-latest' == 'devstral-small'
E         
E         - devstral-small
E         + devstral-latest

/home/rowen/github-branches/vibe/tests/acp/test_new_session.py:140: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins'), PosixPath('/home/rowen/github-branches/vibe/vibe/acp/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/acp/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/acp/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/acp/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/acp/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/acp/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins'), PosixPath('/home/rowen/github-branches/vibe/vibe/acp/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/acp/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/acp/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/acp/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/acp/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/acp/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
_________ test_act_flushes_batched_messages_with_injection_middleware __________
[gw11] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

observer_capture = ([(<Role.system: 'system'>, 'You are Vibe, a super useful programming assistant.'), (<Role.user: 'user'>, 'How can you help?'), (<Role.assistant: 'assistant'>, 'I can write very efficient code.')], <function observer_capture.<locals>.observer at 0x7f1df4e2a520>)

    @pytest.mark.asyncio
    async def test_act_flushes_batched_messages_with_injection_middleware(
        observer_capture,
    ) -> None:
        observed, observer = observer_capture
    
        backend = FakeBackend([mock_llm_chunk(content="I can write very efficient code.")])
        agent = Agent(make_config(), message_observer=observer, backend=backend)
        agent.middleware_pipeline.add(InjectBeforeMiddleware())
    
        async for _ in agent.act("How can you help?"):
            pass
    
        assert len(observed) == 3
        assert [r for r, _ in observed] == [Role.system, Role.user, Role.assistant]
        assert observed[0][1] == "You are Vibe, a super useful programming assistant."
        # injected content should be appended to the user's message before emission
>       assert (
            observed[1][1]
            == f"How can you help?\n\n{InjectBeforeMiddleware.injectedMessage}"
        )
E       AssertionError: assert 'How can you help?' == 'How can you help?\n\n<injected>'
E         
E         - How can you help?
E         ?                  -
E         + How can you help?
E         - 
E         - <injected>

/home/rowen/github-branches/vibe/tests/test_agent_observer_streaming.py:102: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
______________ test_stop_action_flushes_user_msg_before_returning ______________
[gw11] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

observer_capture = ([(<Role.system: 'system'>, 'You are Vibe, a super useful programming assistant.'), (<Role.user: 'user'>, 'Greet.'), (<Role.assistant: 'assistant'>, 'My response will never reach you...')], <function observer_capture.<locals>.observer at 0x7f1df4194180>)

    @pytest.mark.asyncio
    async def test_stop_action_flushes_user_msg_before_returning(observer_capture) -> None:
        observed, observer = observer_capture
    
        # max_turns=0 forces an immediate STOP on the first before_turn
        backend = FakeBackend([
            mock_llm_chunk(content="My response will never reach you...")
        ])
        agent = Agent(
            make_config(), message_observer=observer, max_turns=0, backend=backend
        )
    
        async for _ in agent.act("Greet."):
            pass
    
>       assert len(observed) == 2
E       AssertionError: assert 3 == 2
E        +  where 3 = len([(<Role.system: 'system'>, 'You are Vibe, a super useful programming assistant.'), (<Role.user: 'user'>, 'Greet.'), (<Role.assistant: 'assistant'>, 'My response will never reach you...')])

/home/rowen/github-branches/vibe/tests/test_agent_observer_streaming.py:124: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
__ TestAutoCompactIntegration.test_auto_compact_triggers_and_preserves_stats ___
[gw11] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

self = <tests.test_agent_stats.TestAutoCompactIntegration object at 0x7f1df50b66f0>

    @pytest.mark.asyncio
    async def test_auto_compact_triggers_and_preserves_stats(self) -> None:
        observed: list[tuple[Role, str | None]] = []
    
        def observer(msg: LLMMessage) -> None:
            observed.append((msg.role, msg.content))
    
        backend = FakeBackend([
            [mock_llm_chunk(content="<summary>")],
            [mock_llm_chunk(content="<final>")],
        ])
        cfg = VibeConfig(
            session_logging=SessionLoggingConfig(enabled=False),
            auto_compact_threshold=1,
        )
        agent = Agent(cfg, message_observer=observer, backend=backend)
        agent.stats.context_tokens = 2
    
        events = [ev async for ev in agent.act("Hello")]
    
>       assert len(events) == 3
E       AssertionError: assert 1 == 3
E        +  where 1 = len([AssistantEvent(content='<summary>', stopped_by_middleware=False)])

/home/rowen/github-branches/vibe/tests/test_agent_stats.py:454: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
______________ test_path_completion_popup_shows_up_to_ten_results ______________
[gw1] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

vibe_app = VibeApp(title='VibeApp', classes={'-dark-mode'}, pseudo_classes={'focus', 'dark'})
file_tree = PosixPath('/tmp/pytest-of-rowen/pytest-36/popen-gw1/test_path_completion_popup_sho0')

    @pytest.mark.asyncio
    async def test_path_completion_popup_shows_up_to_ten_results(
        vibe_app: VibeApp, file_tree: Path
    ) -> None:
        async with vibe_app.run_test() as pilot:
            (file_tree / "src" / "core" / "extra").mkdir(parents=True)
            [
                (file_tree / "src" / "core" / "extra" / f"extra_file_{i}.py").write_text(
                    "", encoding="utf-8"
                )
                for i in range(1, 13)
            ]
            popup = vibe_app.query_one(CompletionPopup)
    
            await pilot.press(*"@src/core/extra/")
    
            popup_content = str(popup.render())
            assert "@src/core/extra/extra_file_1.py" in popup_content
            assert "@src/core/extra/extra_file_10.py" in popup_content
>           assert "@src/core/extra/extra_file_11.py" in popup_content
E           AssertionError: assert '@src/core/extra/extra_file_11.py' in '@src/core/extra/extra_file_1.py\n@src/core/extra/extra_file_2.py\n@src/core/extra/extra_file_3.py\n@src/core/extra/extra_file_4.py\n@src/core/extra/extra_file_5.py\n@src/core/extra/extra_file_6.py\n@src/core/extra/extra_file_7.py\n@src/core/extra/extra_file_8.py\n@src/core/extra/extra_file_9.py\n@src/core/extra/extra_file_10.py'

/home/rowen/github-branches/vibe/tests/autocompletion/test_ui_chat_autocompletion.py:182: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
____________ test_snapshot_buffered_reasoning_yields_before_content ____________
[gw7] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

snap_compare = <function snap_compare.<locals>.compare at 0x7fbe840e6840>

    def test_snapshot_buffered_reasoning_yields_before_content(
        snap_compare: SnapCompare,
    ) -> None:
        async def run_before(pilot: Pilot) -> None:
            await pilot.press(*"Give me an answer")
            await pilot.press("enter")
            await pilot.pause(0.5)
    
>       assert snap_compare(
            "test_ui_snapshot_reasoning_content.py:SnapshotTestAppWithBufferedReasoningTransition",
            terminal_size=(120, 36),
            run_before=run_before,
        )
E       AssertionError: assert False
E        +  where False = <function snap_compare.<locals>.compare at 0x7fbe840e6840>('test_ui_snapshot_reasoning_content.py:SnapshotTestAppWithBufferedReasoningTransition', terminal_size=(120, 36), run_before=<function test_snapshot_buffered_reasoning_yields_before_content.<locals>.run_before at 0x7fbe840e6980>)

/home/rowen/github-branches/vibe/tests/snapshots/test_ui_snapshot_reasoning_content.py:142: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
____________________ test_snapshot_shows_basic_conversation ____________________
[gw3] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

snap_compare = <function snap_compare.<locals>.compare at 0x7f77c760b060>

    def test_snapshot_shows_basic_conversation(snap_compare: SnapCompare) -> None:
        async def run_before(pilot: Pilot) -> None:
            await pilot.press(*"Hello there, who are you?")
            await pilot.press("enter")
            await pilot.pause(0.4)
    
>       assert snap_compare(
            "test_ui_snapshot_basic_conversation.py:SnapshotTestAppWithConversation",
            terminal_size=(120, 36),
            run_before=run_before,
        )
E       AssertionError: assert False
E        +  where False = <function snap_compare.<locals>.compare at 0x7f77c760b060>('test_ui_snapshot_basic_conversation.py:SnapshotTestAppWithConversation', terminal_size=(120, 36), run_before=<function test_snapshot_shows_basic_conversation.<locals>.run_before at 0x7f77c760b1a0>)

/home/rowen/github-branches/vibe/tests/snapshots/test_ui_snapshot_basic_conversation.py:37: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
_______________ test_snapshot_shows_release_update_notification ________________
[gw7] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

snap_compare = <function snap_compare.<locals>.compare at 0x7fbe84355080>

    def test_snapshot_shows_release_update_notification(snap_compare: SnapCompare) -> None:
        async def run_before(pilot: Pilot) -> None:
            await pilot.pause(0.2)
    
>       assert snap_compare(
            "test_ui_snapshot_release_update_notification.py:SnapshotTestAppWithUpdate",
            terminal_size=(120, 36),
            run_before=run_before,
        )
E       AssertionError: assert False
E        +  where False = <function snap_compare.<locals>.compare at 0x7fbe84355080>('test_ui_snapshot_release_update_notification.py:SnapshotTestAppWithUpdate', terminal_size=(120, 36), run_before=<function test_snapshot_shows_release_update_notification.<locals>.run_before at 0x7fbe84355bc0>)

/home/rowen/github-branches/vibe/tests/snapshots/test_ui_snapshot_release_update_notification.py:36: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
_______________ test_auto_compact_triggers_and_batches_observer ________________
[gw7] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

    @pytest.mark.asyncio
    async def test_auto_compact_triggers_and_batches_observer() -> None:
        observed: list[tuple[Role, str | None]] = []
    
        def observer(msg: LLMMessage) -> None:
            observed.append((msg.role, msg.content))
    
        backend = FakeBackend([
            [mock_llm_chunk(content="<summary>")],
            [mock_llm_chunk(content="<final>")],
        ])
        cfg = VibeConfig(
            session_logging=SessionLoggingConfig(enabled=False), auto_compact_threshold=1
        )
        agent = Agent(cfg, message_observer=observer, backend=backend)
        agent.stats.context_tokens = 2
    
        events = [ev async for ev in agent.act("Hello")]
    
>       assert len(events) == 3
E       AssertionError: assert 1 == 3
E        +  where 1 = len([AssistantEvent(content='<summary>', stopped_by_middleware=False)])

/home/rowen/github-branches/vibe/tests/test_agent_auto_compact.py:37: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
________ test_snapshot_allows_horizontal_scrolling_for_long_code_blocks ________
[gw3] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

snap_compare = <function snap_compare.<locals>.compare at 0x7f77c6fb1940>

    def test_snapshot_allows_horizontal_scrolling_for_long_code_blocks(
        snap_compare: SnapCompare,
    ) -> None:
        assistant_message_md = """Here's a very long print instruction:
    
    ```python
    def lorem_ipsum():
        # Print a very long line (Lorem Ipsum)
        print("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem.")
    ```
    
    The `print` statement includes a very long line of Lorem Ipsum text to demonstrate a lengthy output."""
    
        async def run_before(pilot: Pilot) -> None:
            app = pilot.app
            assistant_message = AssistantMessage(assistant_message_md)
            messages_area = app.query_one("#messages")
            await messages_area.mount(assistant_message)
            await assistant_message.write_initial_content()
            await pilot.pause(0.1)
    
            markdown_fence = app.query_one(MarkdownFence)
            markdown_fence.scroll_relative(x=15, immediate=True)
    
>       assert snap_compare(
            "base_snapshot_test_app.py:BaseSnapshotTestApp",
            run_before=run_before,
            terminal_size=(120, 36),
        )
E       AssertionError: assert False
E        +  where False = <function snap_compare.<locals>.compare at 0x7f77c6fb1940>('base_snapshot_test_app.py:BaseSnapshotTestApp', run_before=<function test_snapshot_allows_horizontal_scrolling_for_long_code_blocks.<locals>.run_before at 0x7f77c6fb1bc0>, terminal_size=(120, 36))

/home/rowen/github-branches/vibe/tests/snapshots/test_ui_snapshot_code_block_horizontal_scrolling.py:34: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
__________________________ test_snapshot_default_mode __________________________
[gw3] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

snap_compare = <function snap_compare.<locals>.compare at 0x7f77c7081300>

    def test_snapshot_default_mode(snap_compare: SnapCompare) -> None:
        """Test that default mode is displayed correctly at startup."""
    
        async def run_before(pilot: Pilot) -> None:
            await pilot.pause(0.1)
    
>       assert snap_compare(
            "base_snapshot_test_app.py:BaseSnapshotTestApp",
            terminal_size=(120, 36),
            run_before=run_before,
        )
E       AssertionError: assert False
E        +  where False = <function snap_compare.<locals>.compare at 0x7f77c7081300>('base_snapshot_test_app.py:BaseSnapshotTestApp', terminal_size=(120, 36), run_before=<function test_snapshot_default_mode.<locals>.run_before at 0x7f77c7080ea0>)

/home/rowen/github-branches/vibe/tests/snapshots/test_ui_snapshot_modes.py:14: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
_______________________ test_snapshot_cycle_to_plan_mode _______________________
[gw3] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

snap_compare = <function snap_compare.<locals>.compare at 0x7f77c68896c0>

    def test_snapshot_cycle_to_plan_mode(snap_compare: SnapCompare) -> None:
        """Test that shift+tab cycles from default to plan mode."""
    
        async def run_before(pilot: Pilot) -> None:
            await pilot.pause(0.1)
            await pilot.press("shift+tab")  # default -> plan
            await pilot.pause(0.1)
    
>       assert snap_compare(
            "base_snapshot_test_app.py:BaseSnapshotTestApp",
            terminal_size=(120, 36),
            run_before=run_before,
        )
E       AssertionError: assert False
E        +  where False = <function snap_compare.<locals>.compare at 0x7f77c68896c0>('base_snapshot_test_app.py:BaseSnapshotTestApp', terminal_size=(120, 36), run_before=<function test_snapshot_cycle_to_plan_mode.<locals>.run_before at 0x7f77c688a2a0>)

/home/rowen/github-branches/vibe/tests/snapshots/test_ui_snapshot_modes.py:29: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['grep', 'read_file', 'plan_sync', 'todo_write']
___________________ test_snapshot_cycle_to_accept_edits_mode ___________________
[gw3] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

snap_compare = <function snap_compare.<locals>.compare at 0x7f77c65a4220>

    def test_snapshot_cycle_to_accept_edits_mode(snap_compare: SnapCompare) -> None:
        """Test that shift+tab cycles from plan to accept edits mode."""
    
        async def run_before(pilot: Pilot) -> None:
            await pilot.pause(0.1)
            await pilot.press("shift+tab")  # default -> plan
            await pilot.press("shift+tab")  # plan -> accept edits
            await pilot.pause(0.1)
    
>       assert snap_compare(
            "base_snapshot_test_app.py:BaseSnapshotTestApp",
            terminal_size=(120, 36),
            run_before=run_before,
        )
E       AssertionError: assert False
E        +  where False = <function snap_compare.<locals>.compare at 0x7f77c65a4220>('base_snapshot_test_app.py:BaseSnapshotTestApp', terminal_size=(120, 36), run_before=<function test_snapshot_cycle_to_accept_edits_mode.<locals>.run_before at 0x7f77c65a5120>)

/home/rowen/github-branches/vibe/tests/snapshots/test_ui_snapshot_modes.py:45: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['grep', 'read_file', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
___________________ test_snapshot_cycle_to_auto_approve_mode ___________________
[gw3] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

snap_compare = <function snap_compare.<locals>.compare at 0x7f77c6efe700>

    def test_snapshot_cycle_to_auto_approve_mode(snap_compare: SnapCompare) -> None:
        """Test that shift+tab cycles to auto approve mode."""
    
        async def run_before(pilot: Pilot) -> None:
            await pilot.pause(0.1)
            await pilot.press("shift+tab")  # default -> plan
            await pilot.press("shift+tab")  # plan -> accept edits
            await pilot.press("shift+tab")  # accept edits -> auto approve
            await pilot.pause(0.1)
    
>       assert snap_compare(
            "base_snapshot_test_app.py:BaseSnapshotTestApp",
            terminal_size=(120, 36),
            run_before=run_before,
        )
E       AssertionError: assert False
E        +  where False = <function snap_compare.<locals>.compare at 0x7f77c6efe700>('base_snapshot_test_app.py:BaseSnapshotTestApp', terminal_size=(120, 36), run_before=<function test_snapshot_cycle_to_auto_approve_mode.<locals>.run_before at 0x7f77c6efede0>)

/home/rowen/github-branches/vibe/tests/snapshots/test_ui_snapshot_modes.py:62: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['grep', 'read_file', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
_____________________ test_snapshot_cycle_wraps_to_default _____________________
[gw3] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

snap_compare = <function snap_compare.<locals>.compare at 0x7f77c5d88860>

    def test_snapshot_cycle_wraps_to_default(snap_compare: SnapCompare) -> None:
        """Test that shift+tab cycles back to default mode after auto approve."""
    
        async def run_before(pilot: Pilot) -> None:
            await pilot.pause(0.1)
            await pilot.press("shift+tab")  # default -> plan
            await pilot.press("shift+tab")  # plan -> accept edits
            await pilot.press("shift+tab")  # accept edits -> auto approve
            await pilot.press("shift+tab")  # auto approve -> default (wrap)
            await pilot.pause(0.1)
    
>       assert snap_compare(
            "base_snapshot_test_app.py:BaseSnapshotTestApp",
            terminal_size=(120, 36),
            run_before=run_before,
        )
E       AssertionError: assert False
E        +  where False = <function snap_compare.<locals>.compare at 0x7f77c5d88860>('base_snapshot_test_app.py:BaseSnapshotTestApp', terminal_size=(120, 36), run_before=<function test_snapshot_cycle_wraps_to_default.<locals>.run_before at 0x7f77c5d89f80>)

/home/rowen/github-branches/vibe/tests/snapshots/test_ui_snapshot_modes.py:80: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['grep', 'read_file', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
____________________ test_snapshot_shows_reasoning_content _____________________
[gw3] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

snap_compare = <function snap_compare.<locals>.compare at 0x7f77c584d800>

    def test_snapshot_shows_reasoning_content(snap_compare: SnapCompare) -> None:
        async def run_before(pilot: Pilot) -> None:
            await pilot.press(*"What is the answer?")
            await pilot.press("enter")
            await pilot.pause(0.5)
    
>       assert snap_compare(
            "test_ui_snapshot_reasoning_content.py:SnapshotTestAppWithReasoningContent",
            terminal_size=(120, 36),
            run_before=run_before,
        )
E       AssertionError: assert False
E        +  where False = <function snap_compare.<locals>.compare at 0x7f77c584d800>('test_ui_snapshot_reasoning_content.py:SnapshotTestAppWithReasoningContent', terminal_size=(120, 36), run_before=<function test_snapshot_shows_reasoning_content.<locals>.run_before at 0x7f77c584db20>)

/home/rowen/github-branches/vibe/tests/snapshots/test_ui_snapshot_reasoning_content.py:74: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
________________ test_snapshot_shows_reasoning_content_expanded ________________
[gw3] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

snap_compare = <function snap_compare.<locals>.compare at 0x7f77c4ff1580>

    def test_snapshot_shows_reasoning_content_expanded(snap_compare: SnapCompare) -> None:
        async def run_before(pilot: Pilot) -> None:
            await pilot.press(*"What is the answer?")
            await pilot.press("enter")
            await pilot.pause(0.5)
    
            reasoning_msg = pilot.app.query_one(ReasoningMessage)
            await pilot.click(reasoning_msg)
            await pilot.pause(0.1)
    
>       assert snap_compare(
            "test_ui_snapshot_reasoning_content.py:SnapshotTestAppWithReasoningContent",
            terminal_size=(120, 36),
            run_before=run_before,
        )
E       AssertionError: assert False
E        +  where False = <function snap_compare.<locals>.compare at 0x7f77c4ff1580>('test_ui_snapshot_reasoning_content.py:SnapshotTestAppWithReasoningContent', terminal_size=(120, 36), run_before=<function test_snapshot_shows_reasoning_content_expanded.<locals>.run_before at 0x7f77c4ff3c40>)

/home/rowen/github-branches/vibe/tests/snapshots/test_ui_snapshot_reasoning_content.py:91: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
__________________ test_snapshot_shows_interleaved_reasoning ___________________
[gw3] linux -- Python 3.12.8 /home/rowen/github-branches/vibe/.venv/bin/python3

snap_compare = <function snap_compare.<locals>.compare at 0x7f77c6793240>

    def test_snapshot_shows_interleaved_reasoning(snap_compare: SnapCompare) -> None:
        async def run_before(pilot: Pilot) -> None:
            await pilot.press(*"Explain this to me")
            await pilot.press("enter")
            await pilot.pause(0.5)
    
>       assert snap_compare(
            "test_ui_snapshot_reasoning_content.py:SnapshotTestAppWithInterleavedReasoning",
            terminal_size=(120, 36),
            run_before=run_before,
        )
E       AssertionError: assert False
E        +  where False = <function snap_compare.<locals>.compare at 0x7f77c6793240>('test_ui_snapshot_reasoning_content.py:SnapshotTestAppWithInterleavedReasoning', terminal_size=(120, 36), run_before=<function test_snapshot_shows_interleaved_reasoning.<locals>.run_before at 0x7f77c6792b60>)

/home/rowen/github-branches/vibe/tests/snapshots/test_ui_snapshot_reasoning_content.py:104: AssertionError
------------------------------ Captured log call -------------------------------
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:manager.py:58 Computing search paths. Default tool dir: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:78 Unique search paths: [PosixPath('/home/rowen/github-branches/vibe/vibe/core/tools/builtins')]
INFO     vibe:manager.py:88 Scanning directory for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/bash.py
INFO     vibe:manager.py:119 Discovered tool: bash (Bash)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/grep.py
INFO     vibe:manager.py:119 Discovered tool: grep (Grep)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/read_file.py
INFO     vibe:manager.py:119 Discovered tool: read_file (ReadFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/search_replace.py
INFO     vibe:manager.py:119 Discovered tool: search_replace (SearchReplace)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/write_file.py
INFO     vibe:manager.py:119 Discovered tool: write_file (WriteFile)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/delegate_to_local.py
INFO     vibe:manager.py:119 Discovered tool: delegate_to_local (DelegateToLocal)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/plan_sync.py
INFO     vibe:manager.py:119 Discovered tool: plan_sync (PlanSync)
INFO     vibe:manager.py:96 Checking file for tools: /home/rowen/github-branches/vibe/vibe/core/tools/builtins/todo_write.py
INFO     vibe:manager.py:119 Discovered tool: todo_write (TodoWrite)
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
INFO     vibe:format.py:106 Active tools: ['bash', 'grep', 'read_file', 'search_replace', 'write_file', 'delegate_to_local', 'plan_sync', 'todo_write']
=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/pytest_textual_snapshot.py:367
  /home/rowen/github-branches/vibe/.venv/lib/python3.12/site-packages/pytest_textual_snapshot.py:367: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now=datetime.utcnow(),

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
[1;31mTextual Snapshot Report[0m

[1;30;41m12[0m[30;41m mismatched snapshots[0m

[1mView the [0m]8;id=394130;file:///home/rowen/github-branches/vibe/snapshot_report.html\[1mfailure report[0m]8;;\[1m.[0m

[2;35m/home/rowen/github-branches/vibe/[0m[2;95msnapshot_report.html[0m

============================= slowest 5 durations ==============================
5.82s call     tests/onboarding/test_ui_onboarding.py::test_ui_gets_through_the_onboarding_successfully
5.04s call     tests/autocompletion/test_ui_chat_autocompletion.py::test_does_not_trigger_completion_when_navigating_history
4.93s call     tests/acp/test_acp.py::TestToolCallStructure::test_tool_call_update_rejected_structure
4.92s call     tests/onboarding/test_ui_onboarding.py::test_ui_can_pick_a_theme_and_saves_selection
4.78s call     tests/acp/test_acp.py::TestToolCallStructure::test_tool_call_update_approved_structure
=========================== short test summary info ============================
FAILED tests/autocompletion/test_path_completer_recursive.py::test_finds_files_when_pattern_matches_directory_name - AssertionError: assert ['@vibe/acp/', '@vibe/acp/agent.py', '@vibe/acp/entrypoint.py', '@vibe/cli/autocompletion/completers.py', '@tests/autocompletion/', '@vibe/cli/autocompletion/', '@tests/autocompletion/test_fuzzy.py', '@vibe/cli/autocompletion/fuzzy.py'] == ['@vibe/acp/', '@vibe/acp/agent.py', '@vibe/acp/entrypoint.py', '@vibe/cli/autocompletion/completers.py', '@tests/autocompletion/', '@tests/autocompletion/test_fuzzy.py', '@vibe/cli/autocompletion/', '@vibe/cli/autocompletion/fuzzy.py']
  
  At index 5 diff: '@vibe/cli/autocompletion/' != '@tests/autocompletion/test_fuzzy.py'
  
  Full diff:
    [
        '@vibe/acp/',
        '@vibe/acp/agent.py',
        '@vibe/acp/entrypoint.py',
        '@vibe/cli/autocompletion/completers.py',
        '@tests/autocompletion/',
  +     '@vibe/cli/autocompletion/',
        '@tests/autocompletion/test_fuzzy.py',
  -     '@vibe/cli/autocompletion/',
        '@vibe/cli/autocompletion/fuzzy.py',
    ]
FAILED tests/autocompletion/test_path_completion_controller.py::test_lists_root_entries - AssertionError: assert ['@src/', '@README.md'] == ['@README.md', '@src/']
  
  At index 0 diff: '@src/' != '@README.md'
  
  Full diff:
    [
  +     '@src/',
        '@README.md',
  -     '@src/',
    ]
FAILED tests/autocompletion/test_path_completion_controller.py::test_lists_nested_entries_when_prefixing_with_folder_name - AssertionError: assert ['@src/core/', '@src/utils/', '@src/main.py'] == ['@src/core/', '@src/main.py', '@src/utils/']
  
  At index 1 diff: '@src/utils/' != '@src/main.py'
  
  Full diff:
    [
        '@src/core/',
  +     '@src/utils/',
        '@src/main.py',
  -     '@src/utils/',
    ]
FAILED tests/autocompletion/test_path_completion_controller.py::test_applies_selected_completion_on_enter_keycode - AssertionError: assert [(0, 5, '@src/utils/')] == [(0, 5, '@src/main.py')]
  
  At index 0 diff: (0, 5, '@src/utils/') != (0, 5, '@src/main.py')
  
  Full diff:
    [
        (
            0,
            5,
  -         '@src/main.py',
  ?               ^^ ^^^^
  +         '@src/utils/',
  ?               ^^ ^^^
        ),
    ]
FAILED tests/autocompletion/test_path_completion_controller.py::test_navigates_and_cycles_across_suggestions - AssertionError: assert ['@src/core/', '@src/utils/', '@src/main.py'] == ['@src/core/', '@src/main.py', '@src/utils/']
  
  At index 1 diff: '@src/utils/' != '@src/main.py'
  
  Full diff:
    [
        '@src/core/',
  +     '@src/utils/',
        '@src/main.py',
  -     '@src/utils/',
    ]
FAILED tests/autocompletion/test_path_completion_controller.py::test_limits_suggestions_to_ten - AssertionError: assert ['@src/core/extra/extra_file_1.py', '@src/core/extra/extra_file_2.py', '@src/core/extra/extra_file_3.py', '@src/core/extra/extra_file_4.py', '@src/core/extra/extra_file_5.py', '@src/core/extra/extra_file_6.py', '@src/core/extra/extra_file_7.py', '@src/core/extra/extra_file_8.py', '@src/core/extra/extra_file_9.py', '@src/core/extra/extra_file_10.py'] == ['@src/core/extra/extra_file_1.py', '@src/core/extra/extra_file_10.py', '@src/core/extra/extra_file_11.py', '@src/core/extra/extra_file_12.py', '@src/core/extra/extra_file_2.py', '@src/core/extra/extra_file_3.py', '@src/core/extra/extra_file_4.py', '@src/core/extra/extra_file_5.py', '@src/core/extra/extra_file_6.py', '@src/core/extra/extra_file_7.py']
  
  At index 1 diff: '@src/core/extra/extra_file_2.py' != '@src/core/extra/extra_file_10.py'
  
  Full diff:
    [
        '@src/core/extra/extra_file_1.py',
  -     '@src/core/extra/extra_file_10.py',
  -     '@src/core/extra/extra_file_11.py',
  -     '@src/core/extra/extra_file_12.py',
        '@src/core/extra/extra_file_2.py',
        '@src/core/extra/extra_file_3.py',
        '@src/core/extra/extra_file_4.py',
        '@src/core/extra/extra_file_5.py',
        '@src/core/extra/extra_file_6.py',
        '@src/core/extra/extra_file_7.py',
  +     '@src/core/extra/extra_file_8.py',
  +     '@src/core/extra/extra_file_9.py',
  +     '@src/core/extra/extra_file_10.py',
    ]
FAILED tests/acp/test_initialize.py::TestACPInitialize::test_initialize - AssertionError: assert Implementation(name='@l3afyb0y/porker-vibe', title='Porker Vibe', version='1.4.0') == Implementation(name='@mistralai/mistral-vibe', title='Mistral Vibe', version='1.3.5')
  
  Full diff:
  - Implementation(name='@mistralai/mistral-vibe', title='Mistral Vibe', version='1.3.5')
  + Implementation(name='@l3afyb0y/porker-vibe', title='Porker Vibe', version='1.4.0')
FAILED tests/acp/test_initialize.py::TestACPInitialize::test_initialize_with_terminal_auth - AssertionError: assert Implementation(name='@l3afyb0y/porker-vibe', title='Porker Vibe', version='1.4.0') == Implementation(name='@mistralai/mistral-vibe', title='Mistral Vibe', version='1.3.5')
  
  Full diff:
  - Implementation(name='@mistralai/mistral-vibe', title='Mistral Vibe', version='1.3.5')
  + Implementation(name='@l3afyb0y/porker-vibe', title='Porker Vibe', version='1.4.0')
FAILED tests/autocompletion/test_path_completion_controller.py::test_lists_immediate_children_when_path_ends_with_slash - AssertionError: assert ['@src/core/', '@src/utils/', '@src/main.py'] == ['@src/core/', '@src/main.py', '@src/utils/']
  
  At index 1 diff: '@src/utils/' != '@src/main.py'
  
  Full diff:
    [
        '@src/core/',
  +     '@src/utils/',
        '@src/main.py',
  -     '@src/utils/',
    ]
FAILED tests/acp/test_new_session.py::TestACPNewSession::test_new_session_preserves_model_after_set_model - AssertionError: assert 'devstral-latest' == 'devstral-small'
  
  - devstral-small
  + devstral-latest
FAILED tests/test_agent_observer_streaming.py::test_act_flushes_batched_messages_with_injection_middleware - AssertionError: assert 'How can you help?' == 'How can you help?\n\n<injected>'
  
  - How can you help?
  ?                  -
  + How can you help?
  - 
  - <injected>
FAILED tests/test_agent_observer_streaming.py::test_stop_action_flushes_user_msg_before_returning - AssertionError: assert 3 == 2
 +  where 3 = len([(<Role.system: 'system'>, 'You are Vibe, a super useful programming assistant.'), (<Role.user: 'user'>, 'Greet.'), (<Role.assistant: 'assistant'>, 'My response will never reach you...')])
FAILED tests/test_agent_stats.py::TestAutoCompactIntegration::test_auto_compact_triggers_and_preserves_stats - AssertionError: assert 1 == 3
 +  where 1 = len([AssistantEvent(content='<summary>', stopped_by_middleware=False)])
FAILED tests/autocompletion/test_ui_chat_autocompletion.py::test_path_completion_popup_shows_up_to_ten_results - AssertionError: assert '@src/core/extra/extra_file_11.py' in '@src/core/extra/extra_file_1.py\n@src/core/extra/extra_file_2.py\n@src/core/extra/extra_file_3.py\n@src/core/extra/extra_file_4.py\n@src/core/extra/extra_file_5.py\n@src/core/extra/extra_file_6.py\n@src/core/extra/extra_file_7.py\n@src/core/extra/extra_file_8.py\n@src/core/extra/extra_file_9.py\n@src/core/extra/extra_file_10.py'
FAILED tests/snapshots/test_ui_snapshot_reasoning_content.py::test_snapshot_buffered_reasoning_yields_before_content - AssertionError: assert False
 +  where False = <function snap_compare.<locals>.compare at 0x7fbe840e6840>('test_ui_snapshot_reasoning_content.py:SnapshotTestAppWithBufferedReasoningTransition', terminal_size=(120, 36), run_before=<function test_snapshot_buffered_reasoning_yields_before_content.<locals>.run_before at 0x7fbe840e6980>)
FAILED tests/snapshots/test_ui_snapshot_basic_conversation.py::test_snapshot_shows_basic_conversation - AssertionError: assert False
 +  where False = <function snap_compare.<locals>.compare at 0x7f77c760b060>('test_ui_snapshot_basic_conversation.py:SnapshotTestAppWithConversation', terminal_size=(120, 36), run_before=<function test_snapshot_shows_basic_conversation.<locals>.run_before at 0x7f77c760b1a0>)
FAILED tests/snapshots/test_ui_snapshot_release_update_notification.py::test_snapshot_shows_release_update_notification - AssertionError: assert False
 +  where False = <function snap_compare.<locals>.compare at 0x7fbe84355080>('test_ui_snapshot_release_update_notification.py:SnapshotTestAppWithUpdate', terminal_size=(120, 36), run_before=<function test_snapshot_shows_release_update_notification.<locals>.run_before at 0x7fbe84355bc0>)
FAILED tests/test_agent_auto_compact.py::test_auto_compact_triggers_and_batches_observer - AssertionError: assert 1 == 3
 +  where 1 = len([AssistantEvent(content='<summary>', stopped_by_middleware=False)])
FAILED tests/snapshots/test_ui_snapshot_code_block_horizontal_scrolling.py::test_snapshot_allows_horizontal_scrolling_for_long_code_blocks - AssertionError: assert False
 +  where False = <function snap_compare.<locals>.compare at 0x7f77c6fb1940>('base_snapshot_test_app.py:BaseSnapshotTestApp', run_before=<function test_snapshot_allows_horizontal_scrolling_for_long_code_blocks.<locals>.run_before at 0x7f77c6fb1bc0>, terminal_size=(120, 36))
FAILED tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_default_mode - AssertionError: assert False
 +  where False = <function snap_compare.<locals>.compare at 0x7f77c7081300>('base_snapshot_test_app.py:BaseSnapshotTestApp', terminal_size=(120, 36), run_before=<function test_snapshot_default_mode.<locals>.run_before at 0x7f77c7080ea0>)
FAILED tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_cycle_to_plan_mode - AssertionError: assert False
 +  where False = <function snap_compare.<locals>.compare at 0x7f77c68896c0>('base_snapshot_test_app.py:BaseSnapshotTestApp', terminal_size=(120, 36), run_before=<function test_snapshot_cycle_to_plan_mode.<locals>.run_before at 0x7f77c688a2a0>)
FAILED tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_cycle_to_accept_edits_mode - AssertionError: assert False
 +  where False = <function snap_compare.<locals>.compare at 0x7f77c65a4220>('base_snapshot_test_app.py:BaseSnapshotTestApp', terminal_size=(120, 36), run_before=<function test_snapshot_cycle_to_accept_edits_mode.<locals>.run_before at 0x7f77c65a5120>)
FAILED tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_cycle_to_auto_approve_mode - AssertionError: assert False
 +  where False = <function snap_compare.<locals>.compare at 0x7f77c6efe700>('base_snapshot_test_app.py:BaseSnapshotTestApp', terminal_size=(120, 36), run_before=<function test_snapshot_cycle_to_auto_approve_mode.<locals>.run_before at 0x7f77c6efede0>)
FAILED tests/snapshots/test_ui_snapshot_modes.py::test_snapshot_cycle_wraps_to_default - AssertionError: assert False
 +  where False = <function snap_compare.<locals>.compare at 0x7f77c5d88860>('base_snapshot_test_app.py:BaseSnapshotTestApp', terminal_size=(120, 36), run_before=<function test_snapshot_cycle_wraps_to_default.<locals>.run_before at 0x7f77c5d89f80>)
FAILED tests/snapshots/test_ui_snapshot_reasoning_content.py::test_snapshot_shows_reasoning_content - AssertionError: assert False
 +  where False = <function snap_compare.<locals>.compare at 0x7f77c584d800>('test_ui_snapshot_reasoning_content.py:SnapshotTestAppWithReasoningContent', terminal_size=(120, 36), run_before=<function test_snapshot_shows_reasoning_content.<locals>.run_before at 0x7f77c584db20>)
FAILED tests/snapshots/test_ui_snapshot_reasoning_content.py::test_snapshot_shows_reasoning_content_expanded - AssertionError: assert False
 +  where False = <function snap_compare.<locals>.compare at 0x7f77c4ff1580>('test_ui_snapshot_reasoning_content.py:SnapshotTestAppWithReasoningContent', terminal_size=(120, 36), run_before=<function test_snapshot_shows_reasoning_content_expanded.<locals>.run_before at 0x7f77c4ff3c40>)
FAILED tests/snapshots/test_ui_snapshot_reasoning_content.py::test_snapshot_shows_interleaved_reasoning - AssertionError: assert False
 +  where False = <function snap_compare.<locals>.compare at 0x7f77c6793240>('test_ui_snapshot_reasoning_content.py:SnapshotTestAppWithInterleavedReasoning', terminal_size=(120, 36), run_before=<function test_snapshot_shows_interleaved_reasoning.<locals>.run_before at 0x7f77c6792b60>)
============ 27 failed, 524 passed, 2 skipped, 1 warning in 25.74s =============
